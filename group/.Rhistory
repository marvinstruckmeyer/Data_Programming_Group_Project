datos <- readr::read_csv(file = "../../../docencia-R-datascience-2324/entregas/ENTREGA 3 BIS/datos_elecciones_brutos.csv")
datos_tidy <- datos |>
+1s
library(tidyverse)
table4a
datos
datos_tidy <- datos |> pivot_longer(cols = -(tipo_eleccion:votos_candidaturas), names_to = "partido", values_to = "votos", values_drop_na = TRUE)
datos_tidy
datos_tidy |> filter(partido == "PARTIDO POPULAR")
datos_tidy |> filter(str_detect(partido, "PARTIDO POPULAR"))
datos_tidy |> filter(str_detect(partido, "PARTIDO POPULAR")) |> select(partido, votos)
datos_tidy |> filter(str_detect(partido, "PARTIDO POPULAR")) |> select(partido, votos) arrange(desc(partido))
datos_tidy |> filter(str_detect(partido, "PARTIDO POPULAR")) |> select(partido, votos) |>  arrange(desc(partido))
datos_tidy |> filter(str_detect(partido, "PARTIDO NACIONALISTA VASCO")) |> select(partido, votos) |>  arrange(desc(partido))
cod_mun <- read_csv(file = "../../../docencia-R-datascience-2324/entregas/ENTREGA 3 BIS/cod_mun.csv")
cod_mun
datos_tidy |> summarise(across(where(is.numeric), mean))
rm(list = ls())
library(tidyverse)
election_data <- read_csv(file = "./data/datos_elecciones_brutos.csv")
election_data %>% dim()
election_Data %>% glimpse()
election_data %>% glimpse()
election_data %>% is.na() %>% sum()
dim(election_data)[1] * dim(election_data)[2]
(election_data %>% is.na() %>% sum()) / dim(election_data)[1] * dim(election_data)[2]
(election_data %>% is.na() %>% sum()) / (dim(election_data)[1] * dim(election_data)[2])
cod_mun <- read_csv(file = "./data/cod_mun.csv")
cod_mun %>% View()
surveys <- read_csv(file = "./data/historical_surveys.csv")
abbrev <- read_csv(file = "./data/siglas.csv")
abbrev %>% View()
surveys
colnames(surveys)
surveys$type_survey %>% unique()
surveys$type_survey
surveys$field_date_from %>% sort(decreasing = T)
surveys$field_date_from %>% sort(decreasing = T) %>% head(10)
election_data$anno %>% sort(decreasing = T) %>% head(10)
abbrev %>% View()
cod_mun
surveys %>% dim()
install.packages("DBI")
install.packages("DBI")
install.packages("RSQLite")
# reduce size of data objects to be able to upload them to the Claude project
election_data_short <- election_data[1:(nrow(election_data) * 0.3),]
write.csv(election_data_short, "election_data_short.csv")
election_data_short %>% dim()
library(magrittr)
election_data_short %>% dim()
write.csv(election_data_short, "election_data_short.csv")
getwd()
election_data_short <- election_data[1:(nrow(election_data) * 0.35),]
write.csv(election_data_short, "election_data_short.csv")
election_data_short <- election_data[1:(nrow(election_data) * 0.4),]
write.csv(election_data_short, "election_data_short.csv")
glimpse(election_data)
library(tidyverse)
glimpse(election_data)
# Clean historical surveys
surveys_clean <- surveys %>%
# Convert date columns to proper date format
mutate(
date_elec = as.Date(date_elec),
field_date_from = as.Date(field_date_from),
field_date_to = as.Date(field_date_to)
) %>%
# Calculate fieldwork days
mutate(
fieldwork_days = as.numeric(field_date_to - field_date_from)
) %>%
# Apply all filtering conditions
filter(
# Elections from 2018 onwards
date_elec >= as.Date("2018-01-01"),
# Not exit polls
!exit_poll,
# Sample size >= 750 and not unknown (NA)
!is.na(size) & size >= 750,
# More than 1 day of fieldwork
fieldwork_days > 1
)
# Print summary to check the results
summary(surveys_clean)
dim(surveys_clean)
dim(surveys)
clean_surveys %>% View()
surveys_clean %>% View()
clean_surveys %>% colnames()
surveys_clean %>% colnames()
surveys %>% colnames()
# Each team member should install these R packages
install.packages(c("usethis", "gitcreds", "gert"))
