<!DOCTYPE html>
<html lang="en"><head>
<script src="presentation_files/libs/clipboard/clipboard.min.js"></script>
<script src="presentation_files/libs/quarto-html/tabby.min.js"></script>
<script src="presentation_files/libs/quarto-html/popper.min.js"></script>
<script src="presentation_files/libs/quarto-html/tippy.umd.min.js"></script>
<link href="presentation_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="presentation_files/libs/quarto-html/light-border.css" rel="stylesheet">
<link href="presentation_files/libs/quarto-html/quarto-html.min.css" rel="stylesheet" data-mode="light">
<link href="presentation_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles"><meta charset="utf-8">
  <meta name="generator" content="quarto-1.5.57">

  <meta name="author" content="Gina Tedesco, Marvin-Julian Struckmeyer, Ekin Kizildas, Aurora Sterpellone, Estela Moral">
  <title>Data Programming Group Project</title>
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
  <link rel="stylesheet" href="presentation_files/libs/revealjs/dist/reset.css">
  <link rel="stylesheet" href="presentation_files/libs/revealjs/dist/reveal.css">
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
      vertical-align: middle;
    }
    /* CSS for syntax highlighting */
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      { color: #003b4f; background-color: #f1f3f5; }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span { color: #003b4f; } /* Normal */
    code span.al { color: #ad0000; } /* Alert */
    code span.an { color: #5e5e5e; } /* Annotation */
    code span.at { color: #657422; } /* Attribute */
    code span.bn { color: #ad0000; } /* BaseN */
    code span.bu { } /* BuiltIn */
    code span.cf { color: #003b4f; font-weight: bold; } /* ControlFlow */
    code span.ch { color: #20794d; } /* Char */
    code span.cn { color: #8f5902; } /* Constant */
    code span.co { color: #5e5e5e; } /* Comment */
    code span.cv { color: #5e5e5e; font-style: italic; } /* CommentVar */
    code span.do { color: #5e5e5e; font-style: italic; } /* Documentation */
    code span.dt { color: #ad0000; } /* DataType */
    code span.dv { color: #ad0000; } /* DecVal */
    code span.er { color: #ad0000; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #ad0000; } /* Float */
    code span.fu { color: #4758ab; } /* Function */
    code span.im { color: #00769e; } /* Import */
    code span.in { color: #5e5e5e; } /* Information */
    code span.kw { color: #003b4f; font-weight: bold; } /* Keyword */
    code span.op { color: #5e5e5e; } /* Operator */
    code span.ot { color: #003b4f; } /* Other */
    code span.pp { color: #ad0000; } /* Preprocessor */
    code span.sc { color: #5e5e5e; } /* SpecialChar */
    code span.ss { color: #20794d; } /* SpecialString */
    code span.st { color: #20794d; } /* String */
    code span.va { color: #111111; } /* Variable */
    code span.vs { color: #20794d; } /* VerbatimString */
    code span.wa { color: #5e5e5e; font-style: italic; } /* Warning */
  </style>
  <link rel="stylesheet" href="presentation_files/libs/revealjs/dist/theme/quarto.css">
  <link href="presentation_files/libs/revealjs/plugin/quarto-line-highlight/line-highlight.css" rel="stylesheet">
  <link href="presentation_files/libs/revealjs/plugin/reveal-menu/menu.css" rel="stylesheet">
  <link href="presentation_files/libs/revealjs/plugin/reveal-menu/quarto-menu.css" rel="stylesheet">
  <link href="presentation_files/libs/revealjs/plugin/quarto-support/footer.css" rel="stylesheet">
  <style type="text/css">

  .callout {
    margin-top: 1em;
    margin-bottom: 1em;  
    border-radius: .25rem;
  }

  .callout.callout-style-simple { 
    padding: 0em 0.5em;
    border-left: solid #acacac .3rem;
    border-right: solid 1px silver;
    border-top: solid 1px silver;
    border-bottom: solid 1px silver;
    display: flex;
  }

  .callout.callout-style-default {
    border-left: solid #acacac .3rem;
    border-right: solid 1px silver;
    border-top: solid 1px silver;
    border-bottom: solid 1px silver;
  }

  .callout .callout-body-container {
    flex-grow: 1;
  }

  .callout.callout-style-simple .callout-body {
    font-size: 1rem;
    font-weight: 400;
  }

  .callout.callout-style-default .callout-body {
    font-size: 0.9rem;
    font-weight: 400;
  }

  .callout.callout-titled.callout-style-simple .callout-body {
    margin-top: 0.2em;
  }

  .callout:not(.callout-titled) .callout-body {
      display: flex;
  }

  .callout:not(.no-icon).callout-titled.callout-style-simple .callout-content {
    padding-left: 1.6em;
  }

  .callout.callout-titled .callout-header {
    padding-top: 0.2em;
    margin-bottom: -0.2em;
  }

  .callout.callout-titled .callout-title  p {
    margin-top: 0.5em;
    margin-bottom: 0.5em;
  }
    
  .callout.callout-titled.callout-style-simple .callout-content  p {
    margin-top: 0;
  }

  .callout.callout-titled.callout-style-default .callout-content  p {
    margin-top: 0.7em;
  }

  .callout.callout-style-simple div.callout-title {
    border-bottom: none;
    font-size: .9rem;
    font-weight: 600;
    opacity: 75%;
  }

  .callout.callout-style-default  div.callout-title {
    border-bottom: none;
    font-weight: 600;
    opacity: 85%;
    font-size: 0.9rem;
    padding-left: 0.5em;
    padding-right: 0.5em;
  }

  .callout.callout-style-default div.callout-content {
    padding-left: 0.5em;
    padding-right: 0.5em;
  }

  .callout.callout-style-simple .callout-icon::before {
    height: 1rem;
    width: 1rem;
    display: inline-block;
    content: "";
    background-repeat: no-repeat;
    background-size: 1rem 1rem;
  }

  .callout.callout-style-default .callout-icon::before {
    height: 0.9rem;
    width: 0.9rem;
    display: inline-block;
    content: "";
    background-repeat: no-repeat;
    background-size: 0.9rem 0.9rem;
  }

  .callout-title {
    display: flex
  }
    
  .callout-icon::before {
    margin-top: 1rem;
    padding-right: .5rem;
  }

  .callout.no-icon::before {
    display: none !important;
  }

  .callout.callout-titled .callout-body > .callout-content > :last-child {
    padding-bottom: 0.5rem;
    margin-bottom: 0;
  }

  .callout.callout-titled .callout-icon::before {
    margin-top: .5rem;
    padding-right: .5rem;
  }

  .callout:not(.callout-titled) .callout-icon::before {
    margin-top: 1rem;
    padding-right: .5rem;
  }

  /* Callout Types */

  div.callout-note {
    border-left-color: #4582ec !important;
  }

  div.callout-note .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAEU0lEQVRYCcVXTWhcVRQ+586kSUMMxkyaElstCto2SIhitS5Ek8xUKV2poatCcVHtUlFQk8mbaaziwpWgglJwVaquitBOfhQXFlqlzSJpFSpIYyXNjBNiTCck7x2/8/LeNDOZxDuEkgOXe++553zfefee+/OYLOXFk3+1LLrRdiO81yNqZ6K9cG0P3MeFaMIQjXssE8Z1JzLO9ls20MBZX7oG8w9GxB0goaPrW5aNMp1yOZIa7Wv6o2ykpLtmAPs/vrG14Z+6d4jpbSKuhdcSyq9wGMPXjonwmESXrriLzFGOdDBLB8Y6MNYBu0dRokSygMA/mrun8MGFN3behm6VVAwg4WR3i6FvYK1T7MHo9BK7ydH+1uurECoouk5MPRyVSBrBHMYwVobG2aOXM07sWrn5qgB60rc6mcwIDJtQrnrEr44kmy+UO9r0u9O5/YbkS9juQckLed3DyW2XV/qWBBB3ptvI8EUY3I9p/67OW+g967TNr3Sotn3IuVlfMLVnsBwH4fsnebJvyGm5GeIUA3jljERmrv49SizPYuq+z7c2H/jlGC+Ghhupn/hcapqmcudB9jwJ/3jvnvu6vu5lVzF1fXyZuZZ7U8nRmVzytvT+H3kilYvH09mLWrQdwFSsFEsxFVs5fK7A0g8gMZjbif4ACpKbjv7gNGaD8bUrlk8x+KRflttr22JEMRUbTUwwDQScyzPgedQHZT0xnx7ujw2jfVfExwYHwOsDTjLdJ2ebmeQIlJ7neo41s/DrsL3kl+W2lWvAga0tR3zueGr6GL78M3ifH0rGXrBC2aAR8uYcIA5gwV8zIE8onoh8u0Fca/ciF7j1uOzEnqcIm59sEXoGc0+z6+H45V1CvAvHcD7THztu669cnp+L0okAeIc6zjbM/24LgGM1gZk7jnRu1aQWoU9sfUOuhrmtaPIO3YY1KLLWZaEO5TKUbMY5zx8W9UJ6elpLwKXbsaZ4EFl7B4bMtDv0iRipKoDQT2sNQI9b1utXFdYisi+wzZ/ri/1m7QfDgEuvgUUEIJPq3DhX/5DWNqIXDOweC2wvIR90Oq3lDpdMIgD2r0dXvGdsEW5H6x6HLRJYU7C69VefO1x8Gde1ZFSJLfWS1jbCnhtOPxmpfv2LXOA2Xk2tvnwKKPFuZ/oRmwBwqRQDcKNeVQkYcOjtWVBuM/JuYw5b6isojIkYxyYAFn5K7ZBF10fea52y8QltAg6jnMqNHFBmGkQ1j+U43HMi2xMar1Nv0zGsf1s8nUsmUtPOOrbFIR8bHFDMB5zL13Gmr/kGlCkUzedTzzmzsaJXhYawnA3UmARpiYj5ooJZiUoxFRtK3X6pgNPv+IZVPcnwbOl6f+aBaO1CNvPW9n9LmCp01nuSaTRF2YxHqZ8DYQT6WsXT+RD6eUztwYLZ8rM+rcPxamv1VQzFUkzFXvkiVrySGQgJNvXHJAxiU3/NwiC03rSf05VBaPtu/Z7/B8Yn/w7eguloAAAAAElFTkSuQmCC');
  }

  div.callout-note.callout-style-default .callout-title {
    background-color: #dae6fb
  }

  div.callout-important {
    border-left-color: #d9534f !important;
  }

  div.callout-important .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAEKklEQVRYCcVXTWhcVRS+575MJym48A+hSRFr00ySRQhURRfd2HYjk2SSTokuBCkU2o0LoSKKraKIBTcuFCoidGFD08nkBzdREbpQ1EDNIv8qSGMFUboImMSZd4/f9zJv8ibJMC8xJQfO3HPPPef7zrvvvnvviIkpC9nsw0UttFunbUhpFzFtarSd6WJkStVMw5xyVqYTvkwfzuf/5FgtkVoB0729j1rjXwThS7Vio+Mo6DNnvLfahoZ+i/o32lULuJ3NNiz7q6+pyAUkJaFF6JwaM2lUJlV0MlnQn5aTRbEu0SEqHUa0A4AdiGuB1kFXRfVyg5d87+Dg4DL6m2TLAub60ilj7A1Ec4odSAc8X95sHh7+ZRPCFo6Fnp7HfU/fBng/hi10CjCnWnJjsxvDNxWw0NfV6Rv5GgP3I3jGWXumdTD/3cbEOP2ZbOZp69yniG3FQ9z1jD7bnBu9Fc2tKGC2q+uAJOQHBDRiZX1x36o7fWBs7J9ownbtO+n0/qWkvW7UPIfc37WgT6ZGR++EOJyeQDSb9UB+DZ1G6DdLDzyS+b/kBCYGsYgJbSQHuThGKRcw5xdeQf8YdNHsc6ePXrlSYMBuSIAFTGAtQo+VuALo4BX83N190NWZWbynBjhOHsmNfFWLeL6v+ynsA58zDvvAC8j5PkbOcXCMg2PZFk3q8MjI7WAG/Dp9AwP7jdGBOOQkAvlFUB+irtm16I1Zw9YBcpGTGXYmk3kQIC/Cds55l+iMI3jqhjAuaoe+am2Jw5GT3Nbz3CkE12NavmzN5+erJW7046n/CH1RO/RVa8lBLozXk9uqykkGAyRXLWlLv5jyp4RFsG5vGVzpDLnIjTWgnRy2Rr+tDKvRc7Y8AyZq10jj8DqXdnIRNtFZb+t/ZRtXcDiVnzpqx8mPcDWxgARUqx0W1QB9MeUZiNrV4qP+Ehc+BpNgATsTX8ozYKL2NtFYAHc84fG7ndxUPr+AR/iQSns7uSUufAymwDOb2+NjK27lEFocm/EE2WpyIy/Hi66MWuMKJn8RvxIcj87IM5Vh9663ziW36kR0HNenXuxmfaD8JC7tfKbrhFr7LiZCrMjrzTeGx+PmkosrkNzW94ObzwocJ7A1HokLolY+AvkTiD/q1H0cN48c5EL8Crkttsa/AXQVDmutfyku0E7jShx49XqV3MFK8IryDhYVbj7Sj2P2eBxwcXoe8T8idsKKPRcnZw1b+slFTubwUwhktrfnAt7J++jwQtLZcm3sr9LQrjRzz6cfMv9aLvgmnAGvpoaGLxM4mAEaLV7iAzQ3oU0IvD5x9ix3yF2RAAuYAOO2f7PEFWCXZ4C9Pb2UsgDeVnFSpbFK7/IWu7TPTvBqzbGdCHOJQSxiEjt6IyZmxQyEJHv6xyQsYk//moVFsN2zP6fRImjfq7/n/wFDguUQFNEwugAAAABJRU5ErkJggg==');
  }

  div.callout-important.callout-style-default .callout-title {
    background-color: #f7dddc
  }

  div.callout-warning {
    border-left-color: #f0ad4e !important;
  }

  div.callout-warning .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAETklEQVRYCeVWW2gcVRg+58yaTUnizqbipZeX4uWhBEniBaoUX1Ioze52t7sRq6APio9V9MEaoWlVsFasRq0gltaAPuxms8lu0gcviE/FFOstVbSIxgcv6SU7EZqmdc7v9+9mJtNks51NTUH84ed889/PP+cmxP+d5FIbMJmNbpREu4WUkiTtCicKny0l1pIKmBzovF2S+hIJHX8iEu3hZJ5lNZGqyRrGSIQpq15AzF28jgpeY6yk6GVdrfFqdrD6Iw+QlB8g0YS2g7dyQmXM/IDhBhT0UCiRf59lfqmmDvzRt6kByV/m4JjtzuaujMUM2c5Z2d6JdKrRb3K2q6mA+oYVz8JnDdKPmmNthzkAk/lN63sYPgevrguc72aZX/L9C6x09GYyxBgCX4NlvyGUHOKELlm5rXeR1kchuChJt4SSwyddZRXgvwMGvYo4QSlk3/zkHD8UHxwVJA6zjZZqP8v8kK8OWLnIZtLyCAJagYC4rTGW/9Pqj92N/c+LUaAj27movwbi19tk/whRCIE7Q9vyI6yvRpftAKVTdUjOW40X3h5OXsKCdmFcx0xlLJoSuQngnrJe7Kcjm4OMq9FlC7CMmScQANuNvjfP3PjGXDBaUQmbp296S5L4DrpbrHN1T87ZVEZVCzg1FF0Ft+dKrlLukI+/c9ENo+TvlTDbYFvuKPtQ9+l052rXrgKoWkDAFnvh0wTOmYn8R5f4k/jN/fZiCM1tQx9jQQ4ANhqG4hiL0qIFTGViG9DKB7GYzgubnpofgYRwO+DFjh0Zin2m4b/97EDkXkc+f6xYAPX0KK2I/7fUQuwzuwo/L3AkcjugPNixC8cHf0FyPjWlItmLxWw4Ou9YsQCr5fijMGoD/zpdRy95HRysyXA74MWOnscpO4j2y3HAVisw85hX5+AFBRSHt4ShfLFkIMXTqyKFc46xdzQM6XbAi702a7sy04J0+feReMFKp5q9esYLCqAZYw/k14E/xcLLsFElaornTuJB0svMuJINy8xkIYuL+xPAlWRceH6+HX7THJ0djLUom46zREu7tTkxwmf/FdOZ/sh6Q8qvEAiHpm4PJ4a/doJe0gH1t+aHRgCzOvBvJedEK5OFE5jpm4AGP2a8Dxe3gGJ/pAutug9Gp6he92CsSsWBaEcxGx0FHytmIpuqGkOpldqNYQK8cSoXvd+xLxXADw0kf6UkJNFtdo5MOgaLjiQOQHcn+A6h5NuL2s0qsC2LOM75PcF3yr5STuBSAcGG+meA14K/CI21HcS4LBT6tv0QAh8Dr5l93AhZzG5ZJ4VxAqdZUEl9z7WJ4aN+svMvwHHL21UKTd1mqvChH7/Za5xzXBBKrUcB0TQ+Ulgkfbi/H/YT5EptrGzsEK7tR1B7ln9BBwckYfMiuSqklSznIuoIIOM42MQO+QnduCoFCI0bpkzjCjddHPN/F+2Yu+sd9bKNpVwHhbS3LluK/0zgfwD0xYI5dXuzlQAAAABJRU5ErkJggg==');
  }

  div.callout-warning.callout-style-default .callout-title {
    background-color: #fcefdc
  }

  div.callout-tip {
    border-left-color: #02b875 !important;
  }

  div.callout-tip .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAADr0lEQVRYCe1XTWgTQRj9ZjZV8a9SPIkKgj8I1bMHsUWrqYLVg4Ue6v9BwZOxSYsIerFao7UiUryIqJcqgtpimhbBXoSCVxUFe9CTiogUrUp2Pt+3aUI2u5vdNh4dmMzOzHvvezuz8xNFM0mjnbXaNu1MvFWRXkXEyE6aYOYJpdW4IXuA4r0fo8qqSMDBU0v1HJUgVieAXxzCsdE/YJTdFcVIZQNMyhruOMJKXYFoLfIfIvVIMWdsrd+Rpd86ZmyzzjJmLStqRn0v8lzkb4rVIXvnpScOJuAn2ACC65FkPzEdEy4TPWRLJ2h7z4cArXzzaOdKlbOvKKX25Wl00jSnrwVxAg3o4dRxhO13RBSdNvH0xSARv3adTXbBdTf64IWO2vH0LT+cv4GR1DJt+DUItaQogeBX/chhbTBxEiZ6gftlDNXTrvT7co4ub5A6gp9HIcHvzTa46OS5fBeP87Qm0fQkr4FsYgVQ7Qg+ZayaDg9jhg1GkWj8RG6lkeSacrrHgDaxdoBiZPg+NXV/KifMuB6//JmYH4CntVEHy/keA6x4h4CU5oFy8GzrBS18cLJMXcljAKB6INjWsRcuZBWVaS3GDrqB7rdapVIeA+isQ57Eev9eCqzqOa81CY05VLd6SamW2wA2H3SiTbnbSxmzfp7WtKZkqy4mdyAlGx7ennghYf8voqp9cLSgKdqNfa6RdRsAAkPwRuJZNbpByn+RrJi1RXTwdi8RQF6ymDwGMAtZ6TVE+4uoKh+MYkcLsT0Hk8eAienbiGdjJHZTpmNjlbFJNKDVAp2fJlYju6IreQxQ08UJDNYdoLSl6AadO+fFuCQqVMB1NJwPm69T04Wv5WhfcWyfXQB+wXRs1pt+nCknRa0LVzSA/2B+a9+zQJadb7IyyV24YAxKp2Jqs3emZTuNnKxsah+uabKbMk7CbTgJx/zIgQYErIeTKRQ9yD9wxVof5YolPHqaWo7TD6tJlh7jQnK5z2n3+fGdggIOx2kaa2YI9QWarc5Ce1ipNWMKeSG4DysFF52KBmTNMmn5HqCFkwy34rDg05gDwgH3bBi+sgFhN/e8QvRn8kbamCOhgrZ9GJhFDgfcMHzFb6BAtjKpFhzTjwv1KCVuxHvCbsSiEz4CANnj84cwHdFXAbAOJ4LTSAawGWFn5tDhLMYz6nWeU2wJfIhmIJBefcd/A5FWQWGgrWzyORZ3Q6HuV+Jf0Bj+BTX69fm1zWgK7By1YTXchFDORywnfQ7GpzOo6S+qECrsx2ifVQAAAABJRU5ErkJggg==');
  }

  div.callout-tip.callout-style-default .callout-title {
    background-color: #ccf1e3
  }

  div.callout-caution {
    border-left-color: #fd7e14 !important;
  }

  div.callout-caution .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAACV0lEQVRYCdVWzWoUQRCuqp2ICBLJXgITZL1EfQDBW/bkzUMUD7klD+ATSHBEfAIfQO+iXsWDxJsHL96EHAwhgzlkg8nBg25XWb0zIb0zs9muYYWkoKeru+vn664fBqElyZNuyh167NXJ8Ut8McjbmEraKHkd7uAnAFku+VWdb3reSmRV8PKSLfZ0Gjn3a6Xlcq9YGb6tADjn+lUfTXtVmaZ1KwBIvFI11rRXlWlatwIAAv2asaa9mlB9wwygiDX26qaw1yYPzFXg2N1GgG0FMF8Oj+VIx7E/03lHx8UhvYyNZLN7BwSPgekXXLribw7w5/c8EF+DBK5idvDVYtEEwMeYefjjLAdEyQ3M9nfOkgnPTEkYU+sxMq0BxNR6jExrAI31H1rzvLEfRIdgcv1XEdj6QTQAS2wtstEALLG1yEZ3QhH6oDX7ExBSFEkFINXH98NTrme5IOaaA7kIfiu2L8A3qhH9zRbukdCqdsA98TdElyeMe5BI8Rs2xHRIsoTSSVFfCFCWGPn9XHb4cdobRIWABNf0add9jakDjQJpJ1bTXOJXnnRXHRf+dNL1ZV1MBRCXhMbaHqGI1JkKIL7+i8uffuP6wVQAzO7+qVEbF6NbS0LJureYcWXUUhH66nLR5rYmva+2tjRFtojkM2aD76HEGAD3tPtKM309FJg5j/K682ywcWJ3PASCcycH/22u+Bh7Aa0ehM2Fu4z0SAE81HF9RkB21c5bEn4Dzw+/qNOyXr3DCTQDMBOdhi4nAgiFDGCinIa2owCEChUwD8qzd03PG+qdW/4fDzjUMcE1ZpIAAAAASUVORK5CYII=');
  }

  div.callout-caution.callout-style-default .callout-title {
    background-color: #ffe5d0
  }

  </style>
  <style type="text/css">
    .reveal div.sourceCode {
      margin: 0;
      overflow: auto;
    }
    .reveal div.hanging-indent {
      margin-left: 1em;
      text-indent: -1em;
    }
    .reveal .slide:not(.center) {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide.scrollable {
      overflow-y: auto;
    }
    .reveal .footnotes {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide .absolute {
      position: absolute;
      display: block;
    }
    .reveal .footnotes ol {
      counter-reset: ol;
      list-style-type: none; 
      margin-left: 0;
    }
    .reveal .footnotes ol li:before {
      counter-increment: ol;
      content: counter(ol) ". "; 
    }
    .reveal .footnotes ol li > p:first-child {
      display: inline-block;
    }
    .reveal .slide ul,
    .reveal .slide ol {
      margin-bottom: 0.5em;
    }
    .reveal .slide ul li,
    .reveal .slide ol li {
      margin-top: 0.4em;
      margin-bottom: 0.2em;
    }
    .reveal .slide ul[role="tablist"] li {
      margin-bottom: 0;
    }
    .reveal .slide ul li > *:first-child,
    .reveal .slide ol li > *:first-child {
      margin-block-start: 0;
    }
    .reveal .slide ul li > *:last-child,
    .reveal .slide ol li > *:last-child {
      margin-block-end: 0;
    }
    .reveal .slide .columns:nth-child(3) {
      margin-block-start: 0.8em;
    }
    .reveal blockquote {
      box-shadow: none;
    }
    .reveal .tippy-content>* {
      margin-top: 0.2em;
      margin-bottom: 0.7em;
    }
    .reveal .tippy-content>*:last-child {
      margin-bottom: 0.2em;
    }
    .reveal .slide > img.stretch.quarto-figure-center,
    .reveal .slide > img.r-stretch.quarto-figure-center {
      display: block;
      margin-left: auto;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-left,
    .reveal .slide > img.r-stretch.quarto-figure-left  {
      display: block;
      margin-left: 0;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-right,
    .reveal .slide > img.r-stretch.quarto-figure-right  {
      display: block;
      margin-left: auto;
      margin-right: 0; 
    }
  </style>
</head>
<body class="quarto-light">
  <div class="reveal">
    <div class="slides">

<section id="title-slide" class="quarto-title-block center">
  <h1 class="title">Data Programming Group Project</h1>

<div class="quarto-title-authors">
<div class="quarto-title-author">
<div class="quarto-title-author-name">
Gina Tedesco, Marvin-Julian Struckmeyer, Ekin Kizildas, Aurora Sterpellone, Estela Moral 
</div>
</div>
</div>

</section>
<section id="overview" class="slide level2">
<h2>Overview</h2>
<div style="font-size: 0.9em;">
<ul>
<li><p>Exercise 1</p></li>
<li><p>Exercise 2</p></li>
<li><p>Exercise 3</p></li>
<li><p>Exercise 4</p></li>
<li><p>Exercise 5</p></li>
<li><p>Exercise 6</p></li>
<li><p>Original Exercise 1: Dorling Cartogram</p></li>
<li><p>Original Exercise 2: Income and Populistic Voting</p></li>
<li><p>Original Exercise 3: Vox’s electoral performance</p></li>
</ul>
</div>
</section>
<section id="libraries" class="slide level2">
<h2>Libraries</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href=""></a><span class="co"># Github</span></span>
<span id="cb1-2"><a href=""></a><span class="fu">library</span>(gert) </span>
<span id="cb1-3"><a href=""></a></span>
<span id="cb1-4"><a href=""></a><span class="co"># Data cleaning</span></span>
<span id="cb1-5"><a href=""></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1-6"><a href=""></a></span>
<span id="cb1-7"><a href=""></a><span class="co"># Font setting</span></span>
<span id="cb1-8"><a href=""></a><span class="fu">library</span>(sysfonts) </span>
<span id="cb1-9"><a href=""></a><span class="fu">library</span>(showtext) </span>
<span id="cb1-10"><a href=""></a></span>
<span id="cb1-11"><a href=""></a><span class="co"># Maps &amp; Geospatial data</span></span>
<span id="cb1-12"><a href=""></a></span>
<span id="cb1-13"><a href=""></a><span class="fu">library</span>(mapSpain)</span>
<span id="cb1-14"><a href=""></a><span class="fu">library</span>(sf)</span>
<span id="cb1-15"><a href=""></a><span class="fu">library</span>(cartogram)</span>
<span id="cb1-16"><a href=""></a></span>
<span id="cb1-17"><a href=""></a><span class="co"># Others</span></span>
<span id="cb1-18"><a href=""></a><span class="fu">library</span>(stringi) </span>
<span id="cb1-19"><a href=""></a><span class="fu">library</span>(rvest)</span>
<span id="cb1-20"><a href=""></a></span>
<span id="cb1-21"><a href=""></a><span class="co"># Download Excel data</span></span>
<span id="cb1-22"><a href=""></a><span class="fu">library</span>(readxl)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="set-up" class="slide level2">
<h2>Set up</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href=""></a><span class="co"># define a custom theme</span></span>
<span id="cb2-2"><a href=""></a>theme_presentation <span class="ot">&lt;-</span> <span class="cf">function</span>() {</span>
<span id="cb2-3"><a href=""></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb2-4"><a href=""></a>    <span class="fu">theme</span>(</span>
<span id="cb2-5"><a href=""></a>      <span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb2-6"><a href=""></a>      <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">16</span>, <span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb2-7"><a href=""></a>      <span class="at">plot.subtitle =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>),</span>
<span id="cb2-8"><a href=""></a>      <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb2-9"><a href=""></a>      <span class="at">legend.position =</span> <span class="st">"bottom"</span>,</span>
<span id="cb2-10"><a href=""></a>      <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>),)</span>
<span id="cb2-11"><a href=""></a>  }</span>
<span id="cb2-12"><a href=""></a></span>
<span id="cb2-13"><a href=""></a><span class="co"># define the colors</span></span>
<span id="cb2-14"><a href=""></a>party_colors <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb2-15"><a href=""></a>  <span class="st">"PSOE"</span> <span class="ot">=</span> <span class="st">"#F93D46"</span>,</span>
<span id="cb2-16"><a href=""></a>  <span class="st">"PP"</span> <span class="ot">=</span> <span class="st">"#41A4F5"</span>,</span>
<span id="cb2-17"><a href=""></a>  <span class="st">"VOX"</span> <span class="ot">=</span> <span class="st">"#53FF53"</span>,</span>
<span id="cb2-18"><a href=""></a>  <span class="st">"ERC"</span> <span class="ot">=</span> <span class="st">"#FF9E33"</span>,</span>
<span id="cb2-19"><a href=""></a>  <span class="st">"EAJ-PNV"</span> <span class="ot">=</span> <span class="st">"#04B82B"</span>,</span>
<span id="cb2-20"><a href=""></a>  <span class="st">"OTHER"</span> <span class="ot">=</span> <span class="st">"#C0C0C0"</span>)</span>
<span id="cb2-21"><a href=""></a></span>
<span id="cb2-22"><a href=""></a>color_palette <span class="ot">&lt;-</span>  <span class="fu">c</span>(</span>
<span id="cb2-23"><a href=""></a>  <span class="st">"#E69F00"</span>,  <span class="co"># orange</span></span>
<span id="cb2-24"><a href=""></a>  <span class="st">"#56B4E9"</span>,  <span class="co"># light blue</span></span>
<span id="cb2-25"><a href=""></a>  <span class="st">"#009E73"</span>,  <span class="co"># green</span></span>
<span id="cb2-26"><a href=""></a>  <span class="st">"#F0E442"</span>,  <span class="co"># yellow</span></span>
<span id="cb2-27"><a href=""></a>  <span class="st">"#0072B2"</span>,  <span class="co"># dark blue</span></span>
<span id="cb2-28"><a href=""></a>  <span class="st">"#D55E00"</span>,  <span class="co"># red</span></span>
<span id="cb2-29"><a href=""></a>  <span class="st">"#CC79A7"</span>,  <span class="co"># pink</span></span>
<span id="cb2-30"><a href=""></a>  <span class="st">"#999999"</span>,  <span class="co"># grey</span></span>
<span id="cb2-31"><a href=""></a>  <span class="st">"#44AA99"</span>,  <span class="co"># teal</span></span>
<span id="cb2-32"><a href=""></a>  <span class="st">"#332288"</span>,  <span class="co"># indigo</span></span>
<span id="cb2-33"><a href=""></a>  <span class="st">"#AA4499"</span>,  <span class="co"># purple</span></span>
<span id="cb2-34"><a href=""></a>  <span class="st">"#117733"</span>)   <span class="co"># forest green</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="exercise-1" class="slide level2">
<h2>Exercise 1</h2>
<p>Which party was the winner in the municipalities with more than 100,000 habitants (census) in each of the elections?</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href=""></a>big_municipalities <span class="ot">&lt;-</span> election_data<span class="sc">|&gt;</span> </span>
<span id="cb3-2"><a href=""></a>  <span class="fu">filter</span>(censo <span class="sc">&gt;</span> <span class="dv">100000</span>)</span>
<span id="cb3-3"><a href=""></a></span>
<span id="cb3-4"><a href=""></a></span>
<span id="cb3-5"><a href=""></a>winners <span class="ot">&lt;-</span> big_municipalities <span class="sc">|&gt;</span> </span>
<span id="cb3-6"><a href=""></a>  <span class="fu">group_by</span>(codigo_municipio, anno, siglas) <span class="sc">|&gt;</span> </span>
<span id="cb3-7"><a href=""></a>  <span class="fu">summarise</span>(<span class="at">total_votes =</span> <span class="fu">sum</span>(num_votos, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="at">.groups =</span> <span class="st">"drop"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb3-8"><a href=""></a>  <span class="fu">group_by</span>(codigo_municipio, anno) <span class="sc">|&gt;</span> </span>
<span id="cb3-9"><a href=""></a>  <span class="fu">slice_max</span>(total_votes, <span class="at">n =</span> <span class="dv">1</span>)  </span>
<span id="cb3-10"><a href=""></a></span>
<span id="cb3-11"><a href=""></a></span>
<span id="cb3-12"><a href=""></a>winners_plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(winners, <span class="fu">aes</span>(<span class="at">x =</span> anno, <span class="at">fill =</span> siglas)) <span class="sc">+</span></span>
<span id="cb3-13"><a href=""></a>  <span class="fu">geom_bar</span>(<span class="at">position =</span> <span class="st">"dodge"</span>) <span class="sc">+</span> <span class="fu">scale_fill_manual</span>(</span>
<span id="cb3-14"><a href=""></a>    <span class="at">values =</span> party_colors)<span class="sc">+</span></span>
<span id="cb3-15"><a href=""></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Winning Parties in Municipalities"</span>,</span>
<span id="cb3-16"><a href=""></a>       <span class="at">x =</span> <span class="st">"Year"</span>, <span class="at">y =</span> <span class="st">"Number of Municipalities"</span>, <span class="at">fill =</span> <span class="st">"Party"</span>) <span class="sc">+</span></span>
<span id="cb3-17"><a href=""></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section class="slide level2">


<img data-src="presentation_files/figure-revealjs/unnamed-chunk-5-1.png" width="1152" class="r-stretch"></section>
<section class="slide level2">

<p>Regional analysis</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href=""></a><span class="co">#regional analysis</span></span>
<span id="cb4-2"><a href=""></a>regional_summary <span class="ot">&lt;-</span> big_municipalities <span class="sc">|&gt;</span> </span>
<span id="cb4-3"><a href=""></a>  <span class="fu">group_by</span>(codigo_ccaa, partido_2, anno) <span class="sc">|&gt;</span> </span>
<span id="cb4-4"><a href=""></a>  <span class="fu">summarise</span>(<span class="at">total_municipalities =</span> <span class="fu">n</span>(), <span class="at">.groups =</span> <span class="st">"drop"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb4-5"><a href=""></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(total_municipalities))</span>
<span id="cb4-6"><a href=""></a></span>
<span id="cb4-7"><a href=""></a>regional_plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(regional_summary, <span class="fu">aes</span>(<span class="at">x =</span> anno, <span class="at">y =</span> total_municipalities, <span class="at">color =</span> partido_2)) <span class="sc">+</span></span>
<span id="cb4-8"><a href=""></a>  <span class="fu">geom_line</span>(<span class="at">linewidth =</span> <span class="fl">1.2</span>) <span class="sc">+</span> <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="fu">scale_fill_manual</span>(</span>
<span id="cb4-9"><a href=""></a>    <span class="at">values =</span> color_palette)))<span class="sc">+</span></span>
<span id="cb4-10"><a href=""></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>codigo_ccaa) <span class="sc">+</span> </span>
<span id="cb4-11"><a href=""></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Regional Performance of Parties Over Time"</span>,</span>
<span id="cb4-12"><a href=""></a>       <span class="at">x =</span> <span class="st">"Year"</span>, <span class="at">y =</span> <span class="st">"Number of Municipalities"</span>, <span class="at">color =</span> <span class="st">"Party"</span>) <span class="sc">+</span></span>
<span id="cb4-13"><a href=""></a>  <span class="fu">theme_minimal</span>()<span class="sc">+</span></span>
<span id="cb4-14"><a href=""></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_blank</span>(), </span>
<span id="cb4-15"><a href=""></a>        <span class="at">axis.ticks.x =</span> <span class="fu">element_blank</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section class="slide level2">


<img data-src="presentation_files/figure-revealjs/unnamed-chunk-7-1.png" width="1152" class="r-stretch"></section>
<section id="exercise-2" class="slide level2">
<h2>Exercise 2</h2>
<p>Which party was the second when the first was the PSOE? And when the first was the PP?</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href=""></a><span class="co"># Identify winners and second-place parties using siglas</span></span>
<span id="cb5-2"><a href=""></a>ranked_parties <span class="ot">&lt;-</span> big_municipalities <span class="sc">|&gt;</span> </span>
<span id="cb5-3"><a href=""></a>  <span class="fu">group_by</span>(codigo_municipio, anno, siglas) <span class="sc">|&gt;</span> </span>
<span id="cb5-4"><a href=""></a>  <span class="fu">summarise</span>(<span class="at">total_votes =</span> <span class="fu">sum</span>(num_votos, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="at">.groups =</span> <span class="st">"drop"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb5-5"><a href=""></a>  <span class="fu">group_by</span>(codigo_municipio, anno) <span class="sc">|&gt;</span> </span>
<span id="cb5-6"><a href=""></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(total_votes)) <span class="sc">|&gt;</span> </span>
<span id="cb5-7"><a href=""></a>  <span class="fu">mutate</span>(<span class="at">rank =</span> <span class="fu">row_number</span>()) <span class="sc">|&gt;</span> </span>
<span id="cb5-8"><a href=""></a>  <span class="fu">ungroup</span>()</span>
<span id="cb5-9"><a href=""></a></span>
<span id="cb5-10"><a href=""></a><span class="co"># Filter for cases where the first-place party is PSOE or PP</span></span>
<span id="cb5-11"><a href=""></a>second_places <span class="ot">&lt;-</span> ranked_parties <span class="sc">|&gt;</span> </span>
<span id="cb5-12"><a href=""></a>  <span class="fu">filter</span>(rank <span class="sc">&lt;=</span> <span class="dv">2</span>) <span class="sc">|&gt;</span> </span>
<span id="cb5-13"><a href=""></a>  <span class="fu">group_by</span>(codigo_municipio, anno) <span class="sc">|&gt;</span> </span>
<span id="cb5-14"><a href=""></a>  <span class="fu">summarise</span>(</span>
<span id="cb5-15"><a href=""></a>    <span class="at">first_place =</span> siglas[rank <span class="sc">==</span> <span class="dv">1</span>],</span>
<span id="cb5-16"><a href=""></a>    <span class="at">second_place =</span> siglas[rank <span class="sc">==</span> <span class="dv">2</span>],</span>
<span id="cb5-17"><a href=""></a>    <span class="at">.groups =</span> <span class="st">"drop"</span></span>
<span id="cb5-18"><a href=""></a>  ) <span class="sc">|&gt;</span> </span>
<span id="cb5-19"><a href=""></a>  <span class="fu">filter</span>(first_place <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"PSOE"</span>, <span class="st">"PP"</span>))</span>
<span id="cb5-20"><a href=""></a></span>
<span id="cb5-21"><a href=""></a><span class="co"># Plot results</span></span>
<span id="cb5-22"><a href=""></a>firstsecond_plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(second_places, <span class="fu">aes</span>(<span class="at">x =</span> first_place, <span class="at">fill =</span> second_place)) <span class="sc">+</span></span>
<span id="cb5-23"><a href=""></a>  <span class="fu">geom_bar</span>(<span class="at">position =</span> <span class="st">"dodge"</span>) <span class="sc">+</span></span>
<span id="cb5-24"><a href=""></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> party_colors) <span class="sc">+</span></span>
<span id="cb5-25"><a href=""></a>  <span class="fu">labs</span>(</span>
<span id="cb5-26"><a href=""></a>    <span class="at">title =</span> <span class="st">"Second-Place Parties When First is PSOE or PP"</span>,</span>
<span id="cb5-27"><a href=""></a>    <span class="at">x =</span> <span class="st">"First-Place Party"</span>, <span class="at">y =</span> <span class="st">"Number of Municipalities"</span>, <span class="at">fill =</span> <span class="st">"Second-Place Party"</span></span>
<span id="cb5-28"><a href=""></a>  ) <span class="sc">+</span></span>
<span id="cb5-29"><a href=""></a>  <span class="fu">theme_presentation</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section class="slide level2">


<img data-src="presentation_files/figure-revealjs/unnamed-chunk-9-1.png" width="1152" class="r-stretch"></section>
<section class="slide level2">

<p>Taking years into consideration:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href=""></a><span class="co"># Summarize second-place parties over the years using siglas</span></span>
<span id="cb6-2"><a href=""></a>second_places_year <span class="ot">&lt;-</span> ranked_parties <span class="sc">|&gt;</span> </span>
<span id="cb6-3"><a href=""></a>  <span class="fu">filter</span>(rank <span class="sc">&lt;=</span> <span class="dv">2</span>) <span class="sc">|&gt;</span> </span>
<span id="cb6-4"><a href=""></a>  <span class="fu">group_by</span>(codigo_municipio, anno) <span class="sc">|&gt;</span> </span>
<span id="cb6-5"><a href=""></a>  <span class="fu">summarise</span>(</span>
<span id="cb6-6"><a href=""></a>    <span class="at">first_place =</span> siglas[rank <span class="sc">==</span> <span class="dv">1</span>],</span>
<span id="cb6-7"><a href=""></a>    <span class="at">second_place =</span> siglas[rank <span class="sc">==</span> <span class="dv">2</span>],</span>
<span id="cb6-8"><a href=""></a>    <span class="at">.groups =</span> <span class="st">"drop"</span></span>
<span id="cb6-9"><a href=""></a>  ) <span class="sc">|&gt;</span> </span>
<span id="cb6-10"><a href=""></a>  <span class="fu">filter</span>(first_place <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"PSOE"</span>, <span class="st">"PP"</span>))</span>
<span id="cb6-11"><a href=""></a></span>
<span id="cb6-12"><a href=""></a><span class="co"># Plot results: Grouped bar plot with years</span></span>
<span id="cb6-13"><a href=""></a>firstsecond_year_plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(second_places_year, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">factor</span>(anno), <span class="at">fill =</span> second_place)) <span class="sc">+</span></span>
<span id="cb6-14"><a href=""></a>  <span class="fu">geom_bar</span>(<span class="at">position =</span> <span class="st">"dodge"</span>) <span class="sc">+</span></span>
<span id="cb6-15"><a href=""></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> first_place, <span class="at">scales =</span> <span class="st">"free_y"</span>) <span class="sc">+</span></span>
<span id="cb6-16"><a href=""></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> party_colors) <span class="sc">+</span></span>
<span id="cb6-17"><a href=""></a>  <span class="fu">labs</span>(</span>
<span id="cb6-18"><a href=""></a>    <span class="at">title =</span> <span class="st">"Second-Place Parties Over Time When First is PSOE or PP"</span>,</span>
<span id="cb6-19"><a href=""></a>    <span class="at">x =</span> <span class="st">"Year of Election"</span>, <span class="at">y =</span> <span class="st">"Number of Municipalities"</span>,</span>
<span id="cb6-20"><a href=""></a>    <span class="at">fill =</span> <span class="st">"Second-Place Party"</span></span>
<span id="cb6-21"><a href=""></a>  ) <span class="sc">+</span></span>
<span id="cb6-22"><a href=""></a>  <span class="fu">theme_presentation</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section class="slide level2">


<img data-src="presentation_files/figure-revealjs/unnamed-chunk-11-1.png" width="1152" class="r-stretch"></section>
<section id="exercise-3" class="slide level2">
<h2>Exercise 3</h2>
<h3 id="who-benefits-from-low-turnout">Who benefits from low turnout?</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href=""></a><span class="co"># Filter data for the 2016 election year</span></span>
<span id="cb7-2"><a href=""></a>election_data <span class="ot">&lt;-</span> election_data <span class="sc">%&gt;%</span></span>
<span id="cb7-3"><a href=""></a>  <span class="fu">filter</span>(anno <span class="sc">==</span> <span class="dv">2016</span>)  <span class="co"># Include only rows for 2016</span></span>
<span id="cb7-4"><a href=""></a></span>
<span id="cb7-5"><a href=""></a><span class="co"># Categorize turnout based on participacion_1</span></span>
<span id="cb7-6"><a href=""></a>election_data <span class="ot">&lt;-</span> election_data <span class="sc">%&gt;%</span></span>
<span id="cb7-7"><a href=""></a>  <span class="fu">mutate</span>(</span>
<span id="cb7-8"><a href=""></a>    <span class="at">turnout_rate =</span> participacion_1 <span class="sc">/</span> <span class="dv">100</span>,</span>
<span id="cb7-9"><a href=""></a>    <span class="at">turnout_category =</span> <span class="fu">ifelse</span>(turnout_rate <span class="sc">&lt;</span> <span class="fl">0.5</span>, <span class="st">"Low"</span>, <span class="st">"High"</span>)</span>
<span id="cb7-10"><a href=""></a>  )</span>
<span id="cb7-11"><a href=""></a></span>
<span id="cb7-12"><a href=""></a><span class="co"># Summarize votes under Low Turnout using partido_2</span></span>
<span id="cb7-13"><a href=""></a>low_turnout_data <span class="ot">&lt;-</span> election_data <span class="sc">%&gt;%</span></span>
<span id="cb7-14"><a href=""></a>  <span class="fu">filter</span>(turnout_category <span class="sc">==</span> <span class="st">"Low"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb7-15"><a href=""></a>  <span class="fu">group_by</span>(partido_2) <span class="sc">%&gt;%</span></span>
<span id="cb7-16"><a href=""></a>  <span class="fu">summarise</span>(<span class="at">total_votes =</span> <span class="fu">sum</span>(num_votos, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="at">.groups =</span> <span class="st">"drop"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb7-17"><a href=""></a>  <span class="fu">mutate</span>(<span class="at">percentage =</span> total_votes <span class="sc">/</span> <span class="fu">sum</span>(total_votes) <span class="sc">*</span> <span class="dv">100</span>)</span>
<span id="cb7-18"><a href=""></a></span>
<span id="cb7-19"><a href=""></a><span class="co"># Recode partido_2 to abbreviations for plotting</span></span>
<span id="cb7-20"><a href=""></a>low_turnout_data <span class="ot">&lt;-</span> low_turnout_data <span class="sc">%&gt;%</span></span>
<span id="cb7-21"><a href=""></a>  <span class="fu">mutate</span>(</span>
<span id="cb7-22"><a href=""></a>    <span class="at">partido_2 =</span> <span class="fu">recode</span>(partido_2,</span>
<span id="cb7-23"><a href=""></a>                       <span class="st">"CIUDADANOS"</span> <span class="ot">=</span> <span class="st">"CS"</span>,</span>
<span id="cb7-24"><a href=""></a>                       <span class="st">"CONVERGÈNCIA I UNIÓ"</span> <span class="ot">=</span> <span class="st">"CIU"</span>,</span>
<span id="cb7-25"><a href=""></a>                       <span class="st">"EH-BILDU"</span> <span class="ot">=</span> <span class="st">"EH-BILDU"</span>,</span>
<span id="cb7-26"><a href=""></a>                       <span class="st">"ESQUERRA REPUBLICANA DE CATALUNYA"</span> <span class="ot">=</span> <span class="st">"ERC"</span>,</span>
<span id="cb7-27"><a href=""></a>                       <span class="st">"PARTIDO POPULAR"</span> <span class="ot">=</span> <span class="st">"PP"</span>,</span>
<span id="cb7-28"><a href=""></a>                       <span class="st">"PSOE"</span> <span class="ot">=</span> <span class="st">"PSOE"</span>,</span>
<span id="cb7-29"><a href=""></a>                       <span class="st">"VOX"</span> <span class="ot">=</span> <span class="st">"VOX"</span>,</span>
<span id="cb7-30"><a href=""></a>                       <span class="at">.default =</span> <span class="st">"OTHER"</span>)</span>
<span id="cb7-31"><a href=""></a>  )</span>
<span id="cb7-32"><a href=""></a></span>
<span id="cb7-33"><a href=""></a><span class="co"># Set total seats and calculate distribution</span></span>
<span id="cb7-34"><a href=""></a>total_seats <span class="ot">&lt;-</span> <span class="dv">350</span></span>
<span id="cb7-35"><a href=""></a>low_turnout_data <span class="ot">&lt;-</span> low_turnout_data <span class="sc">%&gt;%</span></span>
<span id="cb7-36"><a href=""></a>  <span class="fu">mutate</span>(<span class="at">seats =</span> <span class="fu">round</span>((total_votes <span class="sc">/</span> <span class="fu">sum</span>(total_votes)) <span class="sc">*</span> total_seats))</span>
<span id="cb7-37"><a href=""></a></span>
<span id="cb7-38"><a href=""></a><span class="co"># Expand data to one row per seat</span></span>
<span id="cb7-39"><a href=""></a>seat_positions <span class="ot">&lt;-</span> low_turnout_data <span class="sc">%&gt;%</span></span>
<span id="cb7-40"><a href=""></a>  <span class="fu">uncount</span>(seats) <span class="sc">%&gt;%</span></span>
<span id="cb7-41"><a href=""></a>  <span class="fu">mutate</span>(<span class="at">seat_id =</span> <span class="fu">row_number</span>())</span>
<span id="cb7-42"><a href=""></a></span>
<span id="cb7-43"><a href=""></a><span class="co"># Assign seats to rows and distribute radially by party</span></span>
<span id="cb7-44"><a href=""></a>num_rows <span class="ot">&lt;-</span> <span class="dv">12</span>  <span class="co"># Number of rows for the semicircle</span></span>
<span id="cb7-45"><a href=""></a>seat_positions <span class="ot">&lt;-</span> seat_positions <span class="sc">%&gt;%</span></span>
<span id="cb7-46"><a href=""></a>  <span class="fu">arrange</span>(partido_2) <span class="sc">%&gt;%</span></span>
<span id="cb7-47"><a href=""></a>  <span class="fu">mutate</span>(</span>
<span id="cb7-48"><a href=""></a>    <span class="at">row =</span> ((seat_id <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">%%</span> num_rows) <span class="sc">+</span> <span class="dv">1</span>,</span>
<span id="cb7-49"><a href=""></a>    <span class="at">pos_in_row =</span> ((seat_id <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">%/%</span> num_rows) <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb7-50"><a href=""></a>  )</span>
<span id="cb7-51"><a href=""></a></span>
<span id="cb7-52"><a href=""></a><span class="co"># Calculate x, y coordinates for radial alignment</span></span>
<span id="cb7-53"><a href=""></a>seat_positions <span class="ot">&lt;-</span> seat_positions <span class="sc">%&gt;%</span></span>
<span id="cb7-54"><a href=""></a>  <span class="fu">mutate</span>(</span>
<span id="cb7-55"><a href=""></a>    <span class="at">row_radius =</span> num_rows <span class="sc">-</span> row <span class="sc">+</span> <span class="dv">1</span>,</span>
<span id="cb7-56"><a href=""></a>    <span class="at">angle =</span> (pos_in_row <span class="sc">-</span> <span class="fl">0.5</span>) <span class="sc">/</span> <span class="fu">max</span>(pos_in_row) <span class="sc">*</span> pi,</span>
<span id="cb7-57"><a href=""></a>    <span class="at">x =</span> row_radius <span class="sc">*</span> <span class="fu">cos</span>(angle),</span>
<span id="cb7-58"><a href=""></a>    <span class="at">y =</span> row_radius <span class="sc">*</span> <span class="fu">sin</span>(angle)</span>
<span id="cb7-59"><a href=""></a>  )</span>
<span id="cb7-60"><a href=""></a></span>
<span id="cb7-61"><a href=""></a><span class="co"># Plot the parliamentary diagram</span></span>
<span id="cb7-62"><a href=""></a>parliamentary_plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(seat_positions, <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y, <span class="at">fill =</span> partido_2)) <span class="sc">+</span></span>
<span id="cb7-63"><a href=""></a>  <span class="fu">geom_point</span>(<span class="at">shape =</span> <span class="dv">21</span>, <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb7-64"><a href=""></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> party_colors) <span class="sc">+</span></span>
<span id="cb7-65"><a href=""></a>  <span class="fu">coord_fixed</span>() <span class="sc">+</span></span>
<span id="cb7-66"><a href=""></a>  <span class="fu">labs</span>(</span>
<span id="cb7-67"><a href=""></a>    <span class="at">title =</span> <span class="st">"Spanish Parliamentary Representation Under Low Turnout (2016)"</span>,</span>
<span id="cb7-68"><a href=""></a>    <span class="at">subtitle =</span> <span class="fu">paste</span>(<span class="st">"Proportional allocation of"</span>, total_seats, <span class="st">"seats"</span>),</span>
<span id="cb7-69"><a href=""></a>    <span class="at">x =</span> <span class="cn">NULL</span>,</span>
<span id="cb7-70"><a href=""></a>    <span class="at">y =</span> <span class="cn">NULL</span>,</span>
<span id="cb7-71"><a href=""></a>    <span class="at">fill =</span> <span class="st">"Party"</span></span>
<span id="cb7-72"><a href=""></a>  ) <span class="sc">+</span></span>
<span id="cb7-73"><a href=""></a>  <span class="fu">theme_void</span>() <span class="sc">+</span></span>
<span id="cb7-74"><a href=""></a>  <span class="fu">theme</span>(</span>
<span id="cb7-75"><a href=""></a>    <span class="at">legend.position =</span> <span class="st">"right"</span>,</span>
<span id="cb7-76"><a href=""></a>    <span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb7-77"><a href=""></a>    <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>)</span>
<span id="cb7-78"><a href=""></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section class="slide level2">

<p>Voting Results</p>

<img data-src="presentation_files/figure-revealjs/unnamed-chunk-13-1.png" width="1152" class="r-stretch"></section>
<section id="exercise-4" class="slide level2">
<h2>Exercise 4</h2>
<p>How to analyze the relationship between census and vote? Is it true that certain parties win in rural areas?</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href=""></a>election_data <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">"data/processed/election_data.rds"</span>)</span>
<span id="cb8-2"><a href=""></a></span>
<span id="cb8-3"><a href=""></a><span class="co"># Define rural and urban areas</span></span>
<span id="cb8-4"><a href=""></a>election_data <span class="ot">&lt;-</span> election_data <span class="sc">|&gt;</span> </span>
<span id="cb8-5"><a href=""></a>  <span class="fu">mutate</span>(<span class="at">area_type =</span> <span class="fu">case_when</span>(</span>
<span id="cb8-6"><a href=""></a>    censo <span class="sc">&lt;</span> <span class="dv">10000</span> <span class="sc">~</span> <span class="st">"Rural"</span>,</span>
<span id="cb8-7"><a href=""></a>    censo <span class="sc">&gt;=</span> <span class="dv">10000</span> <span class="sc">~</span> <span class="st">"Urban"</span></span>
<span id="cb8-8"><a href=""></a>  ))</span>
<span id="cb8-9"><a href=""></a></span>
<span id="cb8-10"><a href=""></a><span class="co"># Summarize votes by area type and party</span></span>
<span id="cb8-11"><a href=""></a>area_summary <span class="ot">&lt;-</span> election_data <span class="sc">|&gt;</span> </span>
<span id="cb8-12"><a href=""></a>  <span class="fu">group_by</span>(area_type, siglas) <span class="sc">|&gt;</span> </span>
<span id="cb8-13"><a href=""></a>  <span class="fu">summarise</span>(<span class="at">total_votes =</span> <span class="fu">sum</span>(num_votos, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb8-14"><a href=""></a>            <span class="at">total_municipalities =</span> <span class="fu">n</span>(), <span class="at">.groups =</span> <span class="st">"drop"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb8-15"><a href=""></a>  <span class="fu">mutate</span>(<span class="at">vote_share =</span> total_votes <span class="sc">/</span> <span class="fu">sum</span>(total_votes))</span>
<span id="cb8-16"><a href=""></a></span>
<span id="cb8-17"><a href=""></a><span class="co"># Visualize voting patterns in rural vs. urban areas</span></span>
<span id="cb8-18"><a href=""></a>votingpatterns_plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(area_summary, <span class="fu">aes</span>(<span class="at">x =</span> siglas, <span class="at">y =</span> vote_share, <span class="at">fill =</span> area_type)) <span class="sc">+</span></span>
<span id="cb8-19"><a href=""></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">position =</span> <span class="st">"dodge"</span>) <span class="sc">+</span></span>
<span id="cb8-20"><a href=""></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> color_palette) <span class="sc">+</span></span>
<span id="cb8-21"><a href=""></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Vote Share by Party in Rural vs. Urban Areas"</span>,</span>
<span id="cb8-22"><a href=""></a>       <span class="at">x =</span> <span class="st">"Party"</span>, <span class="at">y =</span> <span class="st">"Vote Share"</span>, <span class="at">fill =</span> <span class="st">"Area Type"</span>) <span class="sc">+</span></span>
<span id="cb8-23"><a href=""></a>  <span class="fu">theme_presentation</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section class="slide level2">


<img data-src="presentation_files/figure-revealjs/unnamed-chunk-15-1.png" width="1152" class="r-stretch"></section>
<section class="slide level2">

<h3 id="relationship-between-census-size-and-vote-share">Relationship between census size and vote share</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href=""></a><span class="co"># Analyze relationship between census size and vote share</span></span>
<span id="cb9-2"><a href=""></a>census_vote <span class="ot">&lt;-</span> election_data <span class="sc">|&gt;</span> </span>
<span id="cb9-3"><a href=""></a>  <span class="fu">group_by</span>(censo, siglas) <span class="sc">|&gt;</span> </span>
<span id="cb9-4"><a href=""></a>  <span class="fu">summarise</span>(<span class="at">total_votes =</span> <span class="fu">sum</span>(num_votos, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="at">.groups =</span> <span class="st">"drop"</span>)</span>
<span id="cb9-5"><a href=""></a></span>
<span id="cb9-6"><a href=""></a><span class="co"># Correlation analysis</span></span>
<span id="cb9-7"><a href=""></a>correlation_results <span class="ot">&lt;-</span> census_vote <span class="sc">|&gt;</span> </span>
<span id="cb9-8"><a href=""></a>  <span class="fu">group_by</span>(siglas) <span class="sc">|&gt;</span> </span>
<span id="cb9-9"><a href=""></a>  <span class="fu">summarise</span>(<span class="at">correlation =</span> <span class="fu">cor</span>(censo, total_votes, <span class="at">use =</span> <span class="st">"complete.obs"</span>))</span>
<span id="cb9-10"><a href=""></a></span>
<span id="cb9-11"><a href=""></a><span class="fu">print</span>(correlation_results)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 12 × 2
   siglas   correlation
   &lt;chr&gt;          &lt;dbl&gt;
 1 BNG           0.0655
 2 CIU           0.217 
 3 CS            0.773 
 4 EAJ-PNV       0.100 
 5 EH-BILDU      0.0764
 6 ERC           0.343 
 7 MP            0.355 
 8 OTHER         0.688 
 9 PP            0.909 
10 PSOE          0.944 
11 UP            0.884 
12 VOX           0.556 </code></pre>
</div>
</div>
</section>
<section class="slide level2">

<h3 id="winning-parties-in-rural-areas">Winning Parties in Rural Areas</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href=""></a><span class="co"># Additional analysis: Top parties in rural areas</span></span>
<span id="cb11-2"><a href=""></a>rural_winners <span class="ot">&lt;-</span> election_data <span class="sc">|&gt;</span> </span>
<span id="cb11-3"><a href=""></a>  <span class="fu">filter</span>(area_type <span class="sc">==</span> <span class="st">"Rural"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb11-4"><a href=""></a>  <span class="fu">group_by</span>(codigo_municipio, anno, siglas) <span class="sc">|&gt;</span> </span>
<span id="cb11-5"><a href=""></a>  <span class="fu">summarise</span>(<span class="at">total_votes =</span> <span class="fu">sum</span>(num_votos, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="at">.groups =</span> <span class="st">"drop"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb11-6"><a href=""></a>  <span class="fu">group_by</span>(codigo_municipio, anno) <span class="sc">|&gt;</span> </span>
<span id="cb11-7"><a href=""></a>  <span class="fu">slice_max</span>(total_votes, <span class="at">n =</span> <span class="dv">1</span>)</span>
<span id="cb11-8"><a href=""></a></span>
<span id="cb11-9"><a href=""></a><span class="co"># We can take the analysis further and:</span></span>
<span id="cb11-10"><a href=""></a><span class="co"># 1. aggregate the data to count how often each party wins in rural areas:</span></span>
<span id="cb11-11"><a href=""></a>rural_party_summary <span class="ot">&lt;-</span> rural_winners <span class="sc">|&gt;</span> </span>
<span id="cb11-12"><a href=""></a>  <span class="fu">group_by</span>(siglas) <span class="sc">|&gt;</span> </span>
<span id="cb11-13"><a href=""></a>  <span class="fu">summarise</span>(<span class="at">wins =</span> <span class="fu">n</span>(), <span class="at">.groups =</span> <span class="st">"drop"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb11-14"><a href=""></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(wins))</span>
<span id="cb11-15"><a href=""></a><span class="co"># 2. Visualize Trends with a bar chart (to visualize which parties dominate in rural areas):</span></span>
<span id="cb11-16"><a href=""></a>ruralareas_parties_plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(rural_party_summary, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">reorder</span>(siglas, wins), <span class="at">y =</span> wins, <span class="at">fill =</span> siglas)) <span class="sc">+</span></span>
<span id="cb11-17"><a href=""></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>) <span class="sc">+</span></span>
<span id="cb11-18"><a href=""></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> party_colors) <span class="sc">+</span></span>
<span id="cb11-19"><a href=""></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Winning Parties in Rural Areas"</span>, <span class="at">x =</span> <span class="st">"Party"</span>, <span class="at">y =</span> <span class="st">"Number of Wins"</span>) <span class="sc">+</span></span>
<span id="cb11-20"><a href=""></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section class="slide level2">


<img data-src="presentation_files/figure-revealjs/unnamed-chunk-18-1.png" width="1152" class="r-stretch"></section>
<section class="slide level2">

<h3 id="vote-percentage-distribution-by-party-in-rural-areas">Vote Percentage Distribution by Party in Rural Areas</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href=""></a><span class="co"># Faceted Histograms: split histogram into separate panels for each party.</span></span>
<span id="cb12-2"><a href=""></a>faceted_plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(election_data, <span class="fu">aes</span>(<span class="at">x =</span> num_votos <span class="sc">/</span> censo <span class="sc">*</span> <span class="dv">100</span>, <span class="at">fill =</span> siglas)) <span class="sc">+</span></span>
<span id="cb12-3"><a href=""></a>  <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="dv">3</span>, <span class="at">color =</span> <span class="st">"white"</span>) <span class="sc">+</span></span>
<span id="cb12-4"><a href=""></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> siglas, <span class="at">scales =</span> <span class="st">"free_y"</span>) <span class="sc">+</span></span>
<span id="cb12-5"><a href=""></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> party_colors) <span class="sc">+</span></span>
<span id="cb12-6"><a href=""></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Vote Percentage Distribution by Party in Rural Areas"</span>,</span>
<span id="cb12-7"><a href=""></a>       <span class="at">x =</span> <span class="st">"Percentage of Votes"</span>,</span>
<span id="cb12-8"><a href=""></a>       <span class="at">y =</span> <span class="st">"Frequency"</span>) <span class="sc">+</span></span>
<span id="cb12-9"><a href=""></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section class="slide level2">


<img data-src="presentation_files/figure-revealjs/unnamed-chunk-20-1.png" width="1152" class="r-stretch"></section>
<section class="slide level2">

<h3 id="vote-percentage-distribution-by-party-in-rural-areas-1">Vote Percentage Distribution by Party in Rural Areas</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href=""></a><span class="do">## !! Overlapping Line Charts (Frequency Polygons)</span></span>
<span id="cb13-2"><a href=""></a>overlapping_plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(election_data, <span class="fu">aes</span>(<span class="at">x =</span> num_votos <span class="sc">/</span> censo <span class="sc">*</span> <span class="dv">100</span>, <span class="at">color =</span> siglas)) <span class="sc">+</span></span>
<span id="cb13-3"><a href=""></a>  <span class="fu">geom_freqpoly</span>(<span class="at">binwidth =</span> <span class="dv">2</span>, <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb13-4"><a href=""></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> party_colors) <span class="sc">+</span></span>
<span id="cb13-5"><a href=""></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Vote Percentage Distribution by Party in Rural Areas"</span>,</span>
<span id="cb13-6"><a href=""></a>       <span class="at">x =</span> <span class="st">"Percentage of Votes"</span>,</span>
<span id="cb13-7"><a href=""></a>       <span class="at">y =</span> <span class="st">"Frequency"</span>,</span>
<span id="cb13-8"><a href=""></a>       <span class="at">color =</span> <span class="st">"Party"</span>) <span class="sc">+</span></span>
<span id="cb13-9"><a href=""></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section class="slide level2">


<img data-src="presentation_files/figure-revealjs/unnamed-chunk-22-1.png" width="1152" class="r-stretch"></section>
<section id="exercise-5" class="slide level2">
<h2>Exercise 5</h2>
<h3 id="how-to-calibrate-the-error-of-the-polls-remember-that-the-polls-are-voting-intentions-at-national-level">How to calibrate the error of the polls (remember that the polls are voting intentions at national level)?</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href=""></a><span class="co"># Set target dates - Changed to November election</span></span>
<span id="cb14-2"><a href=""></a>target_date_survey <span class="ot">&lt;-</span> <span class="fu">as.Date</span>(<span class="st">"2019-11-10"</span>)  <span class="co"># November election date</span></span>
<span id="cb14-3"><a href=""></a>target_date_election <span class="ot">&lt;-</span> <span class="fu">as.Date</span>(<span class="st">"2019-11-01"</span>)  <span class="co"># First of November</span></span>
<span id="cb14-4"><a href=""></a></span>
<span id="cb14-5"><a href=""></a><span class="co"># Create party name mapping with display names and colors</span></span>
<span id="cb14-6"><a href=""></a>party_mapping <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb14-7"><a href=""></a>  <span class="at">survey_name =</span> <span class="fu">c</span>(</span>
<span id="cb14-8"><a href=""></a>    <span class="st">"CIUDADANOS"</span>,</span>
<span id="cb14-9"><a href=""></a>    <span class="st">"PARTIDO NACIONALISTA VASCO"</span>,</span>
<span id="cb14-10"><a href=""></a>    <span class="st">"PARTIDO POPULAR"</span>,</span>
<span id="cb14-11"><a href=""></a>    <span class="st">"PARTIDO SOCIALISTA OBRERO ESPAÑOL"</span>,</span>
<span id="cb14-12"><a href=""></a>    <span class="st">"UNIDAS PODEMOS - IU"</span>,</span>
<span id="cb14-13"><a href=""></a>    <span class="st">"ESQUERRA REPUBLICANA DE CATALUNYA"</span>,</span>
<span id="cb14-14"><a href=""></a>    <span class="st">"EH-BILDU"</span>,</span>
<span id="cb14-15"><a href=""></a>    <span class="st">"VOX"</span>,</span>
<span id="cb14-16"><a href=""></a>    <span class="st">"OTHER"</span></span>
<span id="cb14-17"><a href=""></a>  ),</span>
<span id="cb14-18"><a href=""></a>  <span class="at">election_name =</span> <span class="fu">c</span>(</span>
<span id="cb14-19"><a href=""></a>    <span class="st">"CS"</span>,</span>
<span id="cb14-20"><a href=""></a>    <span class="st">"EAJ-PNV"</span>,</span>
<span id="cb14-21"><a href=""></a>    <span class="st">"PP"</span>,</span>
<span id="cb14-22"><a href=""></a>    <span class="st">"PSOE"</span>,</span>
<span id="cb14-23"><a href=""></a>    <span class="st">"UP"</span>,</span>
<span id="cb14-24"><a href=""></a>    <span class="st">"ERC"</span>,</span>
<span id="cb14-25"><a href=""></a>    <span class="st">"EH-BILDU"</span>,</span>
<span id="cb14-26"><a href=""></a>    <span class="st">"VOX"</span>,</span>
<span id="cb14-27"><a href=""></a>    <span class="st">"OTHER"</span></span>
<span id="cb14-28"><a href=""></a>  ),</span>
<span id="cb14-29"><a href=""></a>  <span class="at">display_name =</span> <span class="fu">c</span>(</span>
<span id="cb14-30"><a href=""></a>    <span class="st">"CS"</span>,</span>
<span id="cb14-31"><a href=""></a>    <span class="st">"EAJ-PNV"</span>,</span>
<span id="cb14-32"><a href=""></a>    <span class="st">"PP"</span>,</span>
<span id="cb14-33"><a href=""></a>    <span class="st">"PSOE"</span>,</span>
<span id="cb14-34"><a href=""></a>    <span class="st">"UP"</span>,</span>
<span id="cb14-35"><a href=""></a>    <span class="st">"ERC"</span>,</span>
<span id="cb14-36"><a href=""></a>    <span class="st">"EH-BILDU"</span>,</span>
<span id="cb14-37"><a href=""></a>    <span class="st">"VOX"</span>,</span>
<span id="cb14-38"><a href=""></a>    <span class="st">"OTHER"</span></span>
<span id="cb14-39"><a href=""></a>  ),</span>
<span id="cb14-40"><a href=""></a>  <span class="at">party_color =</span> <span class="fu">c</span>(</span>
<span id="cb14-41"><a href=""></a>    <span class="st">"#E9521D"</span>,  <span class="co"># CS</span></span>
<span id="cb14-42"><a href=""></a>    <span class="st">"#04B82B"</span>,  <span class="co"># EAJ-PNV</span></span>
<span id="cb14-43"><a href=""></a>    <span class="st">"#41A4F5"</span>,  <span class="co"># PP</span></span>
<span id="cb14-44"><a href=""></a>    <span class="st">"#F93D46"</span>,  <span class="co"># PSOE</span></span>
<span id="cb14-45"><a href=""></a>    <span class="st">"#7C316E"</span>,  <span class="co"># UP</span></span>
<span id="cb14-46"><a href=""></a>    <span class="st">"#FF9E33"</span>,  <span class="co"># ERC</span></span>
<span id="cb14-47"><a href=""></a>    <span class="st">"#03CFB5"</span>,  <span class="co"># EH-BILDU</span></span>
<span id="cb14-48"><a href=""></a>    <span class="st">"#53FF53"</span>,  <span class="co"># VOX</span></span>
<span id="cb14-49"><a href=""></a>    <span class="st">"#C0C0C0"</span>   <span class="co"># OTHER</span></span>
<span id="cb14-50"><a href=""></a>  )</span>
<span id="cb14-51"><a href=""></a>)</span>
<span id="cb14-52"><a href=""></a></span>
<span id="cb14-53"><a href=""></a>data_surveys_filtered <span class="ot">&lt;-</span> surveys <span class="sc">%&gt;%</span></span>
<span id="cb14-54"><a href=""></a>  <span class="fu">filter</span>(date_elec <span class="sc">==</span> target_date_survey) <span class="sc">%&gt;%</span></span>
<span id="cb14-55"><a href=""></a>  <span class="fu">group_by</span>(party_name) <span class="sc">%&gt;%</span></span>
<span id="cb14-56"><a href=""></a>  <span class="fu">summarise</span>(</span>
<span id="cb14-57"><a href=""></a>    <span class="at">vote_intention =</span> <span class="fu">mean</span>(vote_intention, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb14-58"><a href=""></a>    <span class="at">n_polls =</span> <span class="fu">n</span>()</span>
<span id="cb14-59"><a href=""></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb14-60"><a href=""></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(vote_intention)) <span class="sc">%&gt;%</span></span>
<span id="cb14-61"><a href=""></a>  <span class="fu">mutate</span>(<span class="at">vote_share_intention =</span> vote_intention <span class="sc">/</span> <span class="fu">sum</span>(vote_intention) <span class="sc">*</span> <span class="dv">100</span>) <span class="sc">%&gt;%</span></span>
<span id="cb14-62"><a href=""></a>  <span class="fu">left_join</span>(party_mapping, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"party_name"</span> <span class="ot">=</span> <span class="st">"survey_name"</span>))</span>
<span id="cb14-63"><a href=""></a></span>
<span id="cb14-64"><a href=""></a>data_election <span class="ot">&lt;-</span> election_data <span class="sc">%&gt;%</span></span>
<span id="cb14-65"><a href=""></a>  <span class="fu">mutate</span>(<span class="at">date_elec =</span> <span class="fu">as.Date</span>(<span class="fu">paste</span>(anno, mes, <span class="st">"01"</span>, <span class="at">sep =</span> <span class="st">"-"</span>)))</span>
<span id="cb14-66"><a href=""></a>data_election_filtered <span class="ot">&lt;-</span> data_election <span class="sc">%&gt;%</span></span>
<span id="cb14-67"><a href=""></a>  <span class="fu">filter</span>(date_elec <span class="sc">==</span> target_date_election) <span class="sc">%&gt;%</span></span>
<span id="cb14-68"><a href=""></a>  <span class="fu">group_by</span>(siglas) <span class="sc">%&gt;%</span></span>
<span id="cb14-69"><a href=""></a>  <span class="fu">summarise</span>(</span>
<span id="cb14-70"><a href=""></a>    <span class="at">total_votes =</span> <span class="fu">sum</span>(num_votos, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb14-71"><a href=""></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb14-72"><a href=""></a>  <span class="fu">mutate</span>(<span class="at">vote_share_actual =</span> total_votes <span class="sc">/</span> <span class="fu">sum</span>(total_votes) <span class="sc">*</span> <span class="dv">100</span>)</span>
<span id="cb14-73"><a href=""></a></span>
<span id="cb14-74"><a href=""></a><span class="co"># Merge datasets using the mapped names</span></span>
<span id="cb14-75"><a href=""></a>comparison_data <span class="ot">&lt;-</span> data_surveys_filtered <span class="sc">%&gt;%</span></span>
<span id="cb14-76"><a href=""></a>  <span class="fu">left_join</span>(data_election_filtered, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"election_name"</span> <span class="ot">=</span> <span class="st">"siglas"</span>))</span>
<span id="cb14-77"><a href=""></a></span>
<span id="cb14-78"><a href=""></a><span class="co"># Calculate errors</span></span>
<span id="cb14-79"><a href=""></a>comparison_data <span class="ot">&lt;-</span> comparison_data <span class="sc">%&gt;%</span></span>
<span id="cb14-80"><a href=""></a>  <span class="fu">mutate</span>(</span>
<span id="cb14-81"><a href=""></a>    <span class="at">absolute_error =</span> vote_share_intention <span class="sc">-</span> vote_share_actual,</span>
<span id="cb14-82"><a href=""></a>    <span class="at">relative_error =</span> (vote_share_intention <span class="sc">-</span> vote_share_actual) <span class="sc">/</span> vote_share_actual <span class="sc">*</span> <span class="dv">100</span></span>
<span id="cb14-83"><a href=""></a>  )</span>
<span id="cb14-84"><a href=""></a></span>
<span id="cb14-85"><a href=""></a><span class="co"># Calculate overall error metrics</span></span>
<span id="cb14-86"><a href=""></a>error_metrics <span class="ot">&lt;-</span> comparison_data <span class="sc">%&gt;%</span></span>
<span id="cb14-87"><a href=""></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(absolute_error)) <span class="sc">%&gt;%</span></span>
<span id="cb14-88"><a href=""></a>  <span class="fu">summarise</span>(</span>
<span id="cb14-89"><a href=""></a>    <span class="at">mae =</span> <span class="fu">mean</span>(<span class="fu">abs</span>(absolute_error)),</span>
<span id="cb14-90"><a href=""></a>    <span class="at">rmse =</span> <span class="fu">sqrt</span>(<span class="fu">mean</span>(absolute_error<span class="sc">^</span><span class="dv">2</span>)),</span>
<span id="cb14-91"><a href=""></a>    <span class="at">mean_error =</span> <span class="fu">mean</span>(absolute_error)</span>
<span id="cb14-92"><a href=""></a>  )</span>
<span id="cb14-93"><a href=""></a></span>
<span id="cb14-94"><a href=""></a>error_plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(</span>
<span id="cb14-95"><a href=""></a>  comparison_data <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(absolute_error)), </span>
<span id="cb14-96"><a href=""></a>  <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">reorder</span>(display_name, <span class="sc">-</span>vote_share_actual))</span>
<span id="cb14-97"><a href=""></a>) <span class="sc">+</span></span>
<span id="cb14-98"><a href=""></a>  <span class="fu">geom_col</span>(<span class="fu">aes</span>(<span class="at">y =</span> absolute_error), <span class="at">fill =</span> comparison_data<span class="sc">$</span>party_color[<span class="sc">!</span><span class="fu">is.na</span>(comparison_data<span class="sc">$</span>absolute_error)]) <span class="sc">+</span></span>
<span id="cb14-99"><a href=""></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb14-100"><a href=""></a>  <span class="fu">labs</span>(</span>
<span id="cb14-101"><a href=""></a>    <span class="at">title =</span> <span class="st">"Polling Error by Party - November 2019 Election"</span>,</span>
<span id="cb14-102"><a href=""></a>    <span class="at">subtitle =</span> <span class="fu">paste</span>(<span class="st">"Mean Absolute Error:"</span>, <span class="fu">round</span>(error_metrics<span class="sc">$</span>mae, <span class="dv">2</span>), <span class="st">"%"</span>),</span>
<span id="cb14-103"><a href=""></a>    <span class="at">x =</span> <span class="st">"Party"</span>,</span>
<span id="cb14-104"><a href=""></a>    <span class="at">y =</span> <span class="st">"Error in Vote Share (Prediction - Actual) %"</span></span>
<span id="cb14-105"><a href=""></a>  ) <span class="sc">+</span></span>
<span id="cb14-106"><a href=""></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb14-107"><a href=""></a>  <span class="fu">theme</span>(</span>
<span id="cb14-108"><a href=""></a>    <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>),</span>
<span id="cb14-109"><a href=""></a>    <span class="at">panel.grid.major =</span> <span class="fu">element_line</span>(<span class="at">color =</span> <span class="st">"gray90"</span>),</span>
<span id="cb14-110"><a href=""></a>    <span class="at">panel.grid.minor =</span> <span class="fu">element_line</span>(<span class="at">color =</span> <span class="st">"gray95"</span>)</span>
<span id="cb14-111"><a href=""></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section class="slide level2">

<h3 id="polling-inacuracies">Polling Inacuracies</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href=""></a><span class="fu">print</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Detailed Error Analysis:"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "\nDetailed Error Analysis:"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href=""></a><span class="fu">print</span>(comparison_data <span class="sc">%&gt;%</span> </span>
<span id="cb17-2"><a href=""></a>        <span class="fu">select</span>(display_name, vote_share_intention, vote_share_actual, absolute_error, relative_error))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 10 × 5
   display_name vote_share_intention vote_share_actual absolute_error
   &lt;chr&gt;                       &lt;dbl&gt;             &lt;dbl&gt;          &lt;dbl&gt;
 1 CS                          11.5               6.86         4.59  
 2 EH-BILDU                     1.34              1.16         0.179 
 3 ERC                          4.94              3.67         1.27  
 4 &lt;NA&gt;                         4.25             NA           NA     
 5 OTHER                        1.07              7.10        -6.03  
 6 EAJ-PNV                      2.03              1.58         0.451 
 7 PP                          21.1              21.0          0.0539
 8 PSOE                        29.4              28.3          1.09  
 9 UP                          13.4              13.0          0.433 
10 VOX                         11.0              15.3         -4.23  
# ℹ 1 more variable: relative_error &lt;dbl&gt;</code></pre>
</div>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href=""></a><span class="fu">print</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Overall Error Metrics:"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "\nOverall Error Metrics:"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href=""></a><span class="fu">print</span>(error_metrics)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 3
    mae  rmse mean_error
  &lt;dbl&gt; &lt;dbl&gt;      &lt;dbl&gt;
1  2.04  2.96     -0.244</code></pre>
</div>
</div>
</section>
<section class="slide level2">


<img data-src="presentation_files/figure-revealjs/unnamed-chunk-25-1.png" width="1152" class="r-stretch"></section>
<section id="exercise-6" class="slide level2">
<h2>Exercise 6</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href=""></a>election_data_clean <span class="ot">&lt;-</span> election_data <span class="sc">|&gt;</span></span>
<span id="cb23-2"><a href=""></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(partido_2) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(censo) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(num_votos)) <span class="sc">|&gt;</span></span>
<span id="cb23-3"><a href=""></a>  <span class="fu">filter</span>(censo <span class="sc">&gt;</span> <span class="dv">0</span> <span class="sc">&amp;</span> num_votos <span class="sc">&gt;=</span> <span class="dv">0</span>) <span class="sc">|&gt;</span></span>
<span id="cb23-4"><a href=""></a>  <span class="fu">mutate</span>(<span class="at">partido_2 =</span> <span class="fu">str_to_lower</span>(<span class="fu">str_trim</span>(partido_2)))</span>
<span id="cb23-5"><a href=""></a></span>
<span id="cb23-6"><a href=""></a>surveys_clean <span class="ot">&lt;-</span> surveys <span class="sc">|&gt;</span></span>
<span id="cb23-7"><a href=""></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(vote_intention) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(turnout)) <span class="sc">|&gt;</span></span>
<span id="cb23-8"><a href=""></a>  <span class="fu">mutate</span>(</span>
<span id="cb23-9"><a href=""></a>    <span class="at">vote_intention =</span> <span class="fu">ifelse</span>(vote_intention <span class="sc">&gt;</span> <span class="dv">1</span>, vote_intention <span class="sc">/</span> <span class="dv">100</span>, vote_intention),</span>
<span id="cb23-10"><a href=""></a>    <span class="at">turnout =</span> <span class="fu">ifelse</span>(turnout <span class="sc">&gt;</span> <span class="dv">1</span>, turnout <span class="sc">/</span> <span class="dv">100</span>, turnout),</span>
<span id="cb23-11"><a href=""></a>    <span class="at">party_name =</span> <span class="fu">str_to_lower</span>(<span class="fu">str_trim</span>(party_name))</span>
<span id="cb23-12"><a href=""></a>  )</span>
<span id="cb23-13"><a href=""></a></span>
<span id="cb23-14"><a href=""></a></span>
<span id="cb23-15"><a href=""></a>surveys_clean <span class="ot">&lt;-</span> surveys_clean <span class="sc">|&gt;</span></span>
<span id="cb23-16"><a href=""></a>  <span class="fu">group_by</span>(party_name, pollster) <span class="sc">|&gt;</span></span>
<span id="cb23-17"><a href=""></a>  <span class="fu">summarise</span>(</span>
<span id="cb23-18"><a href=""></a>    <span class="at">avg_vote_intention =</span> <span class="fu">mean</span>(vote_intention, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb23-19"><a href=""></a>    <span class="at">avg_turnout =</span> <span class="fu">mean</span>(turnout, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb23-20"><a href=""></a>    <span class="at">.groups =</span> <span class="st">"drop"</span></span>
<span id="cb23-21"><a href=""></a>  )</span>
<span id="cb23-22"><a href=""></a></span>
<span id="cb23-23"><a href=""></a>merged_data <span class="ot">&lt;-</span> election_data_clean<span class="sc">|&gt;</span></span>
<span id="cb23-24"><a href=""></a>  <span class="fu">inner_join</span>(surveys_clean, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"partido_2"</span> <span class="ot">=</span> <span class="st">"party_name"</span>),<span class="at">relationship =</span> <span class="st">"many-to-many"</span>)</span>
<span id="cb23-25"><a href=""></a></span>
<span id="cb23-26"><a href=""></a>merged_data <span class="ot">&lt;-</span> merged_data <span class="sc">|&gt;</span></span>
<span id="cb23-27"><a href=""></a>  <span class="fu">mutate</span>(</span>
<span id="cb23-28"><a href=""></a>    <span class="at">errors =</span> <span class="fu">abs</span>(avg_vote_intention <span class="sc">*</span> <span class="dv">100</span> <span class="sc">-</span> (num_votos <span class="sc">/</span> censo <span class="sc">*</span> <span class="dv">100</span>))</span>
<span id="cb23-29"><a href=""></a>  )</span>
<span id="cb23-30"><a href=""></a></span>
<span id="cb23-31"><a href=""></a>pollster_performance <span class="ot">&lt;-</span> merged_data<span class="sc">%&gt;%</span></span>
<span id="cb23-32"><a href=""></a>  <span class="fu">group_by</span>(pollster) <span class="sc">%&gt;%</span></span>
<span id="cb23-33"><a href=""></a>  <span class="fu">summarise</span>(</span>
<span id="cb23-34"><a href=""></a>    <span class="at">mean_error =</span> <span class="fu">mean</span>(errors, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb23-35"><a href=""></a>    <span class="at">max_error =</span> <span class="fu">max</span>(errors, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb23-36"><a href=""></a>    <span class="at">total_error =</span> <span class="fu">sum</span>(errors, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb23-37"><a href=""></a>    <span class="at">.groups =</span> <span class="st">"drop"</span></span>
<span id="cb23-38"><a href=""></a>  )</span>
<span id="cb23-39"><a href=""></a></span>
<span id="cb23-40"><a href=""></a>best_pollsters <span class="ot">&lt;-</span> pollster_performance <span class="sc">|&gt;</span></span>
<span id="cb23-41"><a href=""></a>  <span class="fu">arrange</span>(mean_error) <span class="sc">|&gt;</span></span>
<span id="cb23-42"><a href=""></a>  <span class="fu">slice</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>)</span>
<span id="cb23-43"><a href=""></a></span>
<span id="cb23-44"><a href=""></a>worst_pollsters <span class="ot">&lt;-</span> pollster_performance <span class="sc">|&gt;</span></span>
<span id="cb23-45"><a href=""></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(mean_error))<span class="sc">|&gt;</span></span>
<span id="cb23-46"><a href=""></a>  <span class="fu">slice</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>)</span>
<span id="cb23-47"><a href=""></a></span>
<span id="cb23-48"><a href=""></a>combined_pollsters <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(</span>
<span id="cb23-49"><a href=""></a>  best_pollsters <span class="sc">|&gt;</span> <span class="fu">mutate</span>(<span class="at">category =</span> <span class="st">"Best"</span>),</span>
<span id="cb23-50"><a href=""></a>  worst_pollsters <span class="sc">|&gt;</span> <span class="fu">mutate</span>(<span class="at">category =</span> <span class="st">"Worst"</span>)</span>
<span id="cb23-51"><a href=""></a>)</span>
<span id="cb23-52"><a href=""></a></span>
<span id="cb23-53"><a href=""></a>combined_pollsters <span class="ot">&lt;-</span> combined_pollsters <span class="sc">%&gt;%</span></span>
<span id="cb23-54"><a href=""></a>  <span class="fu">arrange</span>(mean_error) </span>
<span id="cb23-55"><a href=""></a></span>
<span id="cb23-56"><a href=""></a>pollster_plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(combined_pollsters, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">reorder</span>(pollster, <span class="fu">desc</span>(mean_error)), <span class="at">y =</span> mean_error)) <span class="sc">+</span></span>
<span id="cb23-57"><a href=""></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">position =</span> <span class="st">"dodge"</span>,<span class="at">fill=</span> <span class="st">"blue"</span>) <span class="sc">+</span></span>
<span id="cb23-58"><a href=""></a>  <span class="fu">labs</span>(</span>
<span id="cb23-59"><a href=""></a>    <span class="at">title =</span> <span class="st">"Best and Worst Pollsters by Mean Error"</span>,</span>
<span id="cb23-60"><a href=""></a>    <span class="at">x =</span> <span class="st">"Pollster"</span>,</span>
<span id="cb23-61"><a href=""></a>    <span class="at">y =</span> <span class="st">"Mean Error (Percentage Points)"</span>,</span>
<span id="cb23-62"><a href=""></a>  )  <span class="sc">+</span> <span class="fu">theme_minimal</span>()<span class="sc">+</span></span>
<span id="cb23-63"><a href=""></a>  <span class="fu">coord_flip</span>() </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section class="slide level2">


<img data-src="presentation_files/figure-revealjs/unnamed-chunk-27-1.png" width="1152" class="r-stretch"></section>
<section id="original-exercise-1-dorling-cartogram" class="slide level2">
<h2>Original exercise 1: Dorling cartogram</h2>
<h3 id="first-steps">First steps</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href=""></a><span class="co"># Filter election_data</span></span>
<span id="cb24-2"><a href=""></a>election_data <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">"data/processed/election_data.rds"</span>)</span>
<span id="cb24-3"><a href=""></a></span>
<span id="cb24-4"><a href=""></a>elections_1911 <span class="ot">&lt;-</span> election_data <span class="sc">|&gt;</span> </span>
<span id="cb24-5"><a href=""></a>  <span class="fu">filter</span>(anno <span class="sc">==</span> <span class="dv">2019</span> <span class="sc">&amp;</span> mes <span class="sc">==</span> <span class="dv">11</span>) <span class="sc">|&gt;</span> </span>
<span id="cb24-6"><a href=""></a>  <span class="fu">select</span>(municipio, cod_mun, codigo_provincia, num_votos, siglas, partido, partido_2)</span>
<span id="cb24-7"><a href=""></a></span>
<span id="cb24-8"><a href=""></a>winners_prov <span class="ot">&lt;-</span> elections_1911 <span class="sc">|&gt;</span> </span>
<span id="cb24-9"><a href=""></a>  <span class="fu">group_by</span>(codigo_provincia, siglas) <span class="sc">|&gt;</span>  </span>
<span id="cb24-10"><a href=""></a>  <span class="fu">summarise</span>(<span class="at">votos_totales =</span> <span class="fu">sum</span>(num_votos, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb24-11"><a href=""></a>  <span class="fu">slice_max</span>(votos_totales)</span>
<span id="cb24-12"><a href=""></a></span>
<span id="cb24-13"><a href=""></a><span class="co"># Prepare geospatial data:</span></span>
<span id="cb24-14"><a href=""></a></span>
<span id="cb24-15"><a href=""></a>provinces <span class="ot">&lt;-</span> <span class="fu">esp_get_prov</span>() <span class="sc">|&gt;</span> </span>
<span id="cb24-16"><a href=""></a>  <span class="fu">mutate</span>(<span class="at">provincia =</span> prov.shortname.en) <span class="sc">|&gt;</span> </span>
<span id="cb24-17"><a href=""></a>  <span class="fu">mutate</span>(<span class="at">codigo_provincia =</span> cpro) <span class="sc">|&gt;</span> </span>
<span id="cb24-18"><a href=""></a>  <span class="fu">select</span>(provincia, codigo_provincia)</span>
<span id="cb24-19"><a href=""></a></span>
<span id="cb24-20"><a href=""></a><span class="co"># Set Mercator projection:</span></span>
<span id="cb24-21"><a href=""></a></span>
<span id="cb24-22"><a href=""></a>provinces <span class="ot">&lt;-</span> <span class="fu">st_transform</span>(provinces, <span class="dv">3857</span>)</span>
<span id="cb24-23"><a href=""></a></span>
<span id="cb24-24"><a href=""></a><span class="co"># Population data:</span></span>
<span id="cb24-25"><a href=""></a></span>
<span id="cb24-26"><a href=""></a>pop_prov <span class="ot">&lt;-</span> mapSpain<span class="sc">::</span>pobmun19 <span class="sc">|&gt;</span> </span>
<span id="cb24-27"><a href=""></a>  <span class="fu">rename</span>(<span class="at">codigo_provincia =</span> cpro) <span class="sc">|&gt;</span> </span>
<span id="cb24-28"><a href=""></a>  <span class="fu">group_by</span>(codigo_provincia) <span class="sc">|&gt;</span> </span>
<span id="cb24-29"><a href=""></a>  <span class="fu">summarise</span>(<span class="at">n_pop =</span> <span class="fu">sum</span>(pob19))</span>
<span id="cb24-30"><a href=""></a></span>
<span id="cb24-31"><a href=""></a><span class="co"># Join all dataframes:</span></span>
<span id="cb24-32"><a href=""></a></span>
<span id="cb24-33"><a href=""></a>pop_prov <span class="ot">&lt;-</span> provinces <span class="sc">|&gt;</span> </span>
<span id="cb24-34"><a href=""></a>  <span class="fu">left_join</span>(pop_prov, <span class="at">by =</span> <span class="st">"codigo_provincia"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb24-35"><a href=""></a>  <span class="fu">left_join</span>(winners_prov, <span class="at">by =</span> <span class="st">"codigo_provincia"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section class="slide level2">

<h3 id="create-the-cartogram">Create the cartogram</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href=""></a>pop_prov_cartog <span class="ot">&lt;-</span> <span class="fu">cartogram_dorling</span>(pop_prov, </span>
<span id="cb25-2"><a href=""></a>                                     <span class="at">weight =</span> <span class="st">"n_pop"</span>)</span>
<span id="cb25-3"><a href=""></a></span>
<span id="cb25-4"><a href=""></a>pop_prov_cartog <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(pop_prov_cartog) <span class="sc">+</span></span>
<span id="cb25-5"><a href=""></a>  <span class="fu">geom_sf</span>(<span class="fu">aes</span>(<span class="at">fill =</span> siglas)) <span class="sc">+</span></span>
<span id="cb25-6"><a href=""></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> party_colors,</span>
<span id="cb25-7"><a href=""></a>                    <span class="at">name =</span> <span class="st">"Party"</span>,</span>
<span id="cb25-8"><a href=""></a>                    <span class="at">breaks =</span> <span class="fu">c</span>(<span class="st">"PSOE"</span>, <span class="st">"PP"</span>, <span class="st">"VOX"</span>, <span class="st">"ERC"</span>, <span class="st">"EAJ-PNV"</span>, <span class="st">"OTHER"</span>)) <span class="sc">+</span></span>
<span id="cb25-9"><a href=""></a>  <span class="fu">theme_void</span>() <span class="sc">+</span></span>
<span id="cb25-10"><a href=""></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"2019 November Elections: Most voted party by province"</span>,</span>
<span id="cb25-11"><a href=""></a>       <span class="at">subtitle =</span> <span class="st">"(The size of each circle represents the population of each province)"</span>) <span class="sc">+</span></span>
<span id="cb25-12"><a href=""></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>,</span>
<span id="cb25-13"><a href=""></a>                                  <span class="at">margin =</span> <span class="fu">unit</span>(<span class="fu">c</span>(<span class="fl">0.6</span>, <span class="dv">0</span>, <span class="fl">0.2</span>, <span class="dv">0</span>), <span class="st">"cm"</span>),</span>
<span id="cb25-14"><a href=""></a>                                  <span class="at">size =</span> <span class="dv">18</span>,</span>
<span id="cb25-15"><a href=""></a>                                  <span class="at">family =</span> <span class="st">"rob_cond"</span>),</span>
<span id="cb25-16"><a href=""></a>        <span class="at">plot.subtitle =</span> <span class="fu">element_text</span>(<span class="at">family =</span> <span class="st">"rob_cond"</span>,</span>
<span id="cb25-17"><a href=""></a>                                     <span class="at">size =</span> <span class="dv">14</span>),</span>
<span id="cb25-18"><a href=""></a>        <span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>,</span>
<span id="cb25-19"><a href=""></a>                                    <span class="at">family =</span> <span class="st">"rob_cond"</span>, </span>
<span id="cb25-20"><a href=""></a>                                    <span class="at">size =</span> <span class="dv">15</span>),</span>
<span id="cb25-21"><a href=""></a>        <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">family =</span> <span class="st">"rob_cond"</span>, </span>
<span id="cb25-22"><a href=""></a>                                    <span class="at">size =</span> <span class="dv">12</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section class="slide level2">


<img data-src="presentation_files/figure-revealjs/unnamed-chunk-30-1.png" width="1152" class="r-stretch"></section>
<section id="original-exercise-2-income-and-populist-voting" class="slide level2">
<h2>Original exercise 2: Income and Populist Voting</h2>
<h3 id="first-steps-data-download-and-wrangling">First steps: Data download and wrangling</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href=""></a><span class="co"># source: REGDATA_v70_55_23.xlsx from :</span></span>
<span id="cb26-2"><a href=""></a><span class="co"># https://www.bbvaresearch.com/en/publicaciones/spain-long-series-of-regional-</span></span>
<span id="cb26-3"><a href=""></a><span class="co"># economic-and-demographic-aggregates-2023-update/</span></span>
<span id="cb26-4"><a href=""></a></span>
<span id="cb26-5"><a href=""></a><span class="co"># convert both datasets to long format</span></span>
<span id="cb26-6"><a href=""></a>gdp_long <span class="ot">&lt;-</span> gdp_data <span class="sc">|&gt;</span> </span>
<span id="cb26-7"><a href=""></a>  <span class="fu">pivot_longer</span>(</span>
<span id="cb26-8"><a href=""></a>    <span class="at">cols =</span> <span class="sc">-</span><span class="st">'...1'</span>,</span>
<span id="cb26-9"><a href=""></a>    <span class="at">names_to =</span> <span class="st">"year"</span>,</span>
<span id="cb26-10"><a href=""></a>    <span class="at">values_to =</span> <span class="st">"gdp"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb26-11"><a href=""></a>  <span class="fu">rename</span>(<span class="at">region =</span> <span class="st">'...1'</span>)</span>
<span id="cb26-12"><a href=""></a></span>
<span id="cb26-13"><a href=""></a>pop_long <span class="ot">&lt;-</span> pop_data <span class="sc">|&gt;</span> </span>
<span id="cb26-14"><a href=""></a>  <span class="fu">pivot_longer</span>(</span>
<span id="cb26-15"><a href=""></a>    <span class="at">cols =</span> <span class="sc">-</span><span class="st">'...1'</span>,</span>
<span id="cb26-16"><a href=""></a>    <span class="at">names_to =</span> <span class="st">"year"</span>,</span>
<span id="cb26-17"><a href=""></a>    <span class="at">values_to =</span> <span class="st">"population"</span> ) <span class="sc">|&gt;</span> </span>
<span id="cb26-18"><a href=""></a>  <span class="fu">rename</span>(<span class="at">region =</span> <span class="st">'...1'</span>)</span>
<span id="cb26-19"><a href=""></a></span>
<span id="cb26-20"><a href=""></a><span class="co"># join GDP and population data</span></span>
<span id="cb26-21"><a href=""></a>combined_data <span class="ot">&lt;-</span> gdp_long <span class="sc">|&gt;</span> </span>
<span id="cb26-22"><a href=""></a>  <span class="fu">left_join</span>(pop_long, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"region"</span>, <span class="st">"year"</span>))</span>
<span id="cb26-23"><a href=""></a></span>
<span id="cb26-24"><a href=""></a><span class="co"># calculate GDP per capita</span></span>
<span id="cb26-25"><a href=""></a>gdp_per_capita <span class="ot">&lt;-</span> combined_data <span class="sc">|&gt;</span> </span>
<span id="cb26-26"><a href=""></a>  <span class="fu">mutate</span>(<span class="at">gdp_per_capita =</span> gdp <span class="sc">/</span> population) <span class="sc">|&gt;</span> </span>
<span id="cb26-27"><a href=""></a>  <span class="fu">arrange</span>(region, year)</span>
<span id="cb26-28"><a href=""></a></span>
<span id="cb26-29"><a href=""></a><span class="co"># calculate growth rates (1999-2019)</span></span>
<span id="cb26-30"><a href=""></a>growth_rates <span class="ot">&lt;-</span> gdp_per_capita <span class="sc">|&gt;</span> </span>
<span id="cb26-31"><a href=""></a>  <span class="fu">group_by</span>(region) <span class="sc">|&gt;</span> </span>
<span id="cb26-32"><a href=""></a>  <span class="fu">summarize</span>(</span>
<span id="cb26-33"><a href=""></a>    <span class="at">gdp_per_capita_1999 =</span> <span class="fu">first</span>(gdp_per_capita),</span>
<span id="cb26-34"><a href=""></a>    <span class="at">gdp_per_capita_2019 =</span> <span class="fu">last</span>(gdp_per_capita),</span>
<span id="cb26-35"><a href=""></a>    <span class="at">total_growth =</span> (gdp_per_capita_2019 <span class="sc">/</span> gdp_per_capita_1999 <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">*</span> <span class="dv">100</span>) <span class="sc">|&gt;</span> </span>
<span id="cb26-36"><a href=""></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(total_growth))</span>
<span id="cb26-37"><a href=""></a></span>
<span id="cb26-38"><a href=""></a><span class="co"># calculate national average growth</span></span>
<span id="cb26-39"><a href=""></a>national_avg_growth <span class="ot">&lt;-</span> <span class="fu">mean</span>(growth_rates<span class="sc">$</span>total_growth)</span>
<span id="cb26-40"><a href=""></a></span>
<span id="cb26-41"><a href=""></a><span class="co"># add relative growth compared to national average</span></span>
<span id="cb26-42"><a href=""></a>growth_rates <span class="ot">&lt;-</span> growth_rates <span class="sc">|&gt;</span> </span>
<span id="cb26-43"><a href=""></a>  <span class="fu">mutate</span>(</span>
<span id="cb26-44"><a href=""></a>    <span class="at">relative_growth =</span> total_growth <span class="sc">-</span> national_avg_growth,</span>
<span id="cb26-45"><a href=""></a>    <span class="at">growth_category =</span> <span class="fu">if_else</span>(relative_growth <span class="sc">&gt;=</span> <span class="dv">0</span>, <span class="st">"Above Average"</span>, <span class="st">"Below Average"</span>))</span>
<span id="cb26-46"><a href=""></a></span>
<span id="cb26-47"><a href=""></a><span class="co"># view results</span></span>
<span id="cb26-48"><a href=""></a><span class="fu">print</span>(<span class="st">"GDP per capita growth rates by region (1999-2019):"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "GDP per capita growth rates by region (1999-2019):"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href=""></a><span class="fu">print</span>(growth_rates)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 19 × 6
   region gdp_per_capita_1999 gdp_per_capita_2019 total_growth relative_growth
   &lt;chr&gt;                &lt;dbl&gt;               &lt;dbl&gt;        &lt;dbl&gt;           &lt;dbl&gt;
 1 EXT                   14.0                21.3        52.0           28.0  
 2 GAL                   17.5                24.8        41.5           17.6  
 3 CYL                   19.1                26.0        35.8           11.9  
 4 PV                    26.2                34.6        32.3            8.33 
 5 ARA                   23.4                30.4        29.7            5.76 
 6 MAD                   29.3                37.9        29.2            5.19 
 7 AST                   19.4                24.7        27.1            3.15 
 8 AND                   16.5                20.8        25.7            1.76 
 9 total                 22.2                27.7        25.0            1.05 
10 NAV                   26.6                33.2        24.6            0.670
11 CLM                   17.9                22.2        24.3            0.361
12 CANT                  20.7                25.4        23.0           -0.947
13 MUR                   19.2                23.0        19.3           -4.62 
14 CAT                   27.4                32.5        18.9           -5.10 
15 RIO                   24.3                28.8        18.5           -5.50 
16 VAL                   21.2                24.2        14.3           -9.63 
17 CyMel                 18.2                19.9         9.15         -14.8  
18 CAN                   21.3                21.9         2.81         -21.2  
19 BAL                   29.8                30.4         2.07         -21.9  
# ℹ 1 more variable: growth_category &lt;chr&gt;</code></pre>
</div>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href=""></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">"National average growth rate:"</span>, <span class="fu">round</span>(national_avg_growth, <span class="dv">2</span>), <span class="st">"%"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "National average growth rate: 23.97 %"</code></pre>
</div>
</div>
</section>
<section class="slide level2">

<h3 id="next-get-vox-election-results-and-join">Next: Get VOX election results and join</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href=""></a>election_data <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">"data/processed/election_data.rds"</span>)</span>
<span id="cb32-2"><a href=""></a></span>
<span id="cb32-3"><a href=""></a><span class="co"># calculate VOX results by CCAA for November 2019</span></span>
<span id="cb32-4"><a href=""></a>vox_results_2019 <span class="ot">&lt;-</span> election_data <span class="sc">|&gt;</span> </span>
<span id="cb32-5"><a href=""></a>  <span class="fu">filter</span>(anno <span class="sc">==</span> <span class="dv">2019</span>, mes <span class="sc">==</span> <span class="dv">11</span>) <span class="sc">|&gt;</span> </span>
<span id="cb32-6"><a href=""></a>  <span class="fu">mutate</span>(</span>
<span id="cb32-7"><a href=""></a>    <span class="at">party_group =</span> <span class="fu">case_when</span>(</span>
<span id="cb32-8"><a href=""></a>      partido_2 <span class="sc">==</span> <span class="st">"VOX"</span> <span class="sc">~</span> <span class="st">"VOX"</span>,</span>
<span id="cb32-9"><a href=""></a>      <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"OTHER"</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb32-10"><a href=""></a>  <span class="fu">group_by</span>(codigo_ccaa, party_group) <span class="sc">|&gt;</span> </span>
<span id="cb32-11"><a href=""></a>  <span class="fu">summarise</span>(</span>
<span id="cb32-12"><a href=""></a>    <span class="at">votes =</span> <span class="fu">sum</span>(num_votos, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb32-13"><a href=""></a>    <span class="at">.groups =</span> <span class="st">'drop'</span>) <span class="sc">|&gt;</span> </span>
<span id="cb32-14"><a href=""></a>  <span class="fu">pivot_wider</span>(</span>
<span id="cb32-15"><a href=""></a>    <span class="at">names_from =</span> party_group,</span>
<span id="cb32-16"><a href=""></a>    <span class="at">values_from =</span> votes,</span>
<span id="cb32-17"><a href=""></a>    <span class="at">values_fill =</span> <span class="dv">0</span>) <span class="sc">|&gt;</span> </span>
<span id="cb32-18"><a href=""></a>  <span class="fu">mutate</span>(</span>
<span id="cb32-19"><a href=""></a>    <span class="at">total_votes =</span> VOX <span class="sc">+</span> OTHER,</span>
<span id="cb32-20"><a href=""></a>    <span class="at">vox_percentage =</span> (VOX <span class="sc">/</span> total_votes) <span class="sc">*</span> <span class="dv">100</span>)</span>
<span id="cb32-21"><a href=""></a></span>
<span id="cb32-22"><a href=""></a><span class="co"># create lookup table with official CCAA codes</span></span>
<span id="cb32-23"><a href=""></a><span class="co"># this is based on https://www.ine.es/en/daco/daco42/codmun/cod_ccaa_en.htm</span></span>
<span id="cb32-24"><a href=""></a>ccaa_lookup <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb32-25"><a href=""></a>  <span class="at">codigo_ccaa =</span> <span class="fu">c</span>(<span class="fu">paste0</span>(<span class="st">"0"</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">9</span>), <span class="fu">as.character</span>(<span class="dv">10</span><span class="sc">:</span><span class="dv">17</span>), <span class="st">"18"</span>, <span class="st">"19"</span>),</span>
<span id="cb32-26"><a href=""></a>  <span class="at">region =</span> <span class="fu">c</span>(<span class="st">"AND"</span>, <span class="st">"ARA"</span>, <span class="st">"AST"</span>, <span class="st">"BAL"</span>, <span class="st">"CAN"</span>, <span class="st">"CANT"</span>, <span class="st">"CYL"</span>, <span class="st">"CLM"</span>, </span>
<span id="cb32-27"><a href=""></a>             <span class="st">"CAT"</span>, <span class="st">"VAL"</span>, <span class="st">"EXT"</span>, <span class="st">"GAL"</span>, <span class="st">"MAD"</span>, <span class="st">"MUR"</span>, <span class="st">"NAV"</span>, <span class="st">"PV"</span>, </span>
<span id="cb32-28"><a href=""></a>             <span class="st">"RIO"</span>, <span class="st">"CyMel"</span>, <span class="st">"CyMel"</span>))</span>
<span id="cb32-29"><a href=""></a></span>
<span id="cb32-30"><a href=""></a><span class="co"># join CCAA codes with results and combine Ceuta and Melilla</span></span>
<span id="cb32-31"><a href=""></a>vox_results_2019_named <span class="ot">&lt;-</span> vox_results_2019 <span class="sc">|&gt;</span> </span>
<span id="cb32-32"><a href=""></a>  <span class="fu">left_join</span>(ccaa_lookup, <span class="at">by =</span> <span class="st">"codigo_ccaa"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb32-33"><a href=""></a>  <span class="fu">group_by</span>(region) <span class="sc">|&gt;</span> </span>
<span id="cb32-34"><a href=""></a>  <span class="fu">summarise</span>(</span>
<span id="cb32-35"><a href=""></a>    <span class="at">VOX =</span> <span class="fu">sum</span>(VOX),</span>
<span id="cb32-36"><a href=""></a>    <span class="at">OTHER =</span> <span class="fu">sum</span>(OTHER),</span>
<span id="cb32-37"><a href=""></a>    <span class="at">total_votes =</span> <span class="fu">sum</span>(total_votes),</span>
<span id="cb32-38"><a href=""></a>    <span class="at">vox_percentage =</span> (<span class="fu">sum</span>(VOX) <span class="sc">/</span> <span class="fu">sum</span>(total_votes)) <span class="sc">*</span> <span class="dv">100</span>) <span class="sc">|&gt;</span> </span>
<span id="cb32-39"><a href=""></a>  <span class="fu">arrange</span>(region)</span>
<span id="cb32-40"><a href=""></a></span>
<span id="cb32-41"><a href=""></a><span class="co"># now join with GDP growth data</span></span>
<span id="cb32-42"><a href=""></a>combined_analysis <span class="ot">&lt;-</span> growth_rates <span class="sc">|&gt;</span> </span>
<span id="cb32-43"><a href=""></a>  <span class="fu">filter</span>(region <span class="sc">!=</span> <span class="st">"total"</span>) <span class="sc">|&gt;</span> <span class="co"># Remove the 'total' row</span></span>
<span id="cb32-44"><a href=""></a>  <span class="fu">left_join</span>(vox_results_2019_named, <span class="at">by =</span> <span class="st">"region"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb32-45"><a href=""></a>  <span class="fu">select</span>(region, relative_growth, vox_percentage, growth_category)</span>
<span id="cb32-46"><a href=""></a></span>
<span id="cb32-47"><a href=""></a><span class="co"># print combined results</span></span>
<span id="cb32-48"><a href=""></a><span class="fu">print</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Combined GDP growth and VOX support analysis:"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "\nCombined GDP growth and VOX support analysis:"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href=""></a><span class="fu">print</span>(combined_analysis)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 18 × 4
   region relative_growth vox_percentage growth_category
   &lt;chr&gt;            &lt;dbl&gt;          &lt;dbl&gt; &lt;chr&gt;          
 1 EXT             28.0             7.89 Above Average  
 2 GAL             17.6            18.5  Above Average  
 3 CYL             11.9            22.1  Above Average  
 4 PV               8.33           11.6  Above Average  
 5 ARA              5.76           17.8  Above Average  
 6 MAD              5.19            5.85 Above Average  
 7 AST              3.15           16.1  Above Average  
 8 AND              1.76           20.6  Above Average  
 9 NAV              0.670          28.2  Above Average  
10 CLM              0.361          16.8  Above Average  
11 CANT            -0.947          15.0  Below Average  
12 MUR             -4.62            2.47 Below Average  
13 CAT             -5.10            6.34 Below Average  
14 RIO             -5.50           18.6  Below Average  
15 VAL             -9.63           17.0  Below Average  
16 CyMel          -14.8            27.8  Below Average  
17 CAN            -21.2            12.6  Below Average  
18 BAL            -21.9            17.3  Below Average  </code></pre>
</div>
</div>
</section>
<section class="slide level2">

<h3 id="analysis-and-scatterplot">Analysis and scatterplot</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href=""></a><span class="co"># calculate correlation (excluding NA values)</span></span>
<span id="cb36-2"><a href=""></a>correlation <span class="ot">&lt;-</span> <span class="fu">cor</span>(combined_analysis<span class="sc">$</span>relative_growth, </span>
<span id="cb36-3"><a href=""></a>                   combined_analysis<span class="sc">$</span>vox_percentage,</span>
<span id="cb36-4"><a href=""></a>                   <span class="at">use =</span> <span class="st">"complete.obs"</span>)  <span class="co"># this will exclude NA values</span></span>
<span id="cb36-5"><a href=""></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Correlation between relative GDP growth and VOX support:"</span>, <span class="fu">round</span>(correlation, <span class="dv">3</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "\nCorrelation between relative GDP growth and VOX support: -0.142"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href=""></a><span class="co"># create scatter plot</span></span>
<span id="cb38-2"><a href=""></a>scatter_plot_1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(combined_analysis, <span class="fu">aes</span>(<span class="at">x =</span> relative_growth, <span class="at">y =</span> vox_percentage)) <span class="sc">+</span></span>
<span id="cb38-3"><a href=""></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">color =</span> growth_category), <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb38-4"><a href=""></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> region), <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.5</span>, <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb38-5"><a href=""></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">color =</span> color_palette[<span class="dv">6</span>], <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb38-6"><a href=""></a>  <span class="fu">labs</span>(</span>
<span id="cb38-7"><a href=""></a>    <span class="at">title =</span> <span class="st">"Relationship between Economic Growth and VOX Support"</span>,</span>
<span id="cb38-8"><a href=""></a>    <span class="at">subtitle =</span> <span class="st">"By Autonomous Community (1999-2019)"</span>,</span>
<span id="cb38-9"><a href=""></a>    <span class="at">x =</span> <span class="st">"Relative GDP per Capita Growth (%)"</span>,</span>
<span id="cb38-10"><a href=""></a>    <span class="at">y =</span> <span class="st">"VOX Vote Share (%)"</span>,</span>
<span id="cb38-11"><a href=""></a>    <span class="at">color =</span> <span class="st">"Growth Category"</span></span>
<span id="cb38-12"><a href=""></a>  ) <span class="sc">+</span></span>
<span id="cb38-13"><a href=""></a>  <span class="fu">theme_presentation</span>() <span class="sc">+</span></span>
<span id="cb38-14"><a href=""></a>  <span class="fu">theme</span>(</span>
<span id="cb38-15"><a href=""></a>    <span class="at">legend.position =</span> <span class="st">"bottom"</span>,</span>
<span id="cb38-16"><a href=""></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section class="slide level2">


<img data-src="presentation_files/figure-revealjs/unnamed-chunk-34-1.png" width="1152" class="r-stretch"></section>
<section id="original-exercise-3-voxs-electoral-performance" class="slide level2">
<h2>Original Exercise 3: Vox’s electoral performance</h2>
<h3 id="exercise">Exercise:</h3>
<p>Analyze VOX’s electoral performance in the Nov 2019 general election by studying (1) how voter turnout relates to VOX’s electoral success across municipalities, (2) visualising the geographic concentration in the support of Vox, and (3) studying electoral fragmentation.</p>
</section>
<section class="slide level2">

<h3 id="analysing-how-voter-turnout-relates-to-voxs-electoral-success">Analysing how voter turnout relates to Vox’s electoral success</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href=""></a><span class="co"># first, let's create municipality_summary for November 2019 (using both month and year)</span></span>
<span id="cb39-2"><a href=""></a>municipality_summary_2019 <span class="ot">&lt;-</span> election_data <span class="sc">|&gt;</span> </span>
<span id="cb39-3"><a href=""></a>  <span class="fu">filter</span>(anno <span class="sc">==</span> <span class="dv">2019</span>, mes <span class="sc">==</span> <span class="dv">11</span>) <span class="sc">|&gt;</span>   <span class="co"># specifying November 2019</span></span>
<span id="cb39-4"><a href=""></a>  <span class="fu">group_by</span>(municipio) <span class="sc">|&gt;</span> </span>
<span id="cb39-5"><a href=""></a>  <span class="fu">slice</span>(<span class="dv">1</span>) <span class="sc">|&gt;</span> </span>
<span id="cb39-6"><a href=""></a>  <span class="fu">summarise</span>(</span>
<span id="cb39-7"><a href=""></a>    <span class="at">censo =</span> censo,</span>
<span id="cb39-8"><a href=""></a>    <span class="at">total_votes =</span> votos_candidaturas <span class="sc">+</span> votos_blancos <span class="sc">+</span> votos_nulos,</span>
<span id="cb39-9"><a href=""></a>    <span class="at">valid_votes =</span> votos_candidaturas,</span>
<span id="cb39-10"><a href=""></a>    <span class="at">turnout =</span> (total_votes <span class="sc">/</span> censo) <span class="sc">*</span> <span class="dv">100</span>) <span class="sc">|&gt;</span> </span>
<span id="cb39-11"><a href=""></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(turnout), turnout <span class="sc">&lt;=</span> <span class="dv">100</span>, turnout <span class="sc">&gt;</span> <span class="dv">0</span>)</span>
<span id="cb39-12"><a href=""></a></span>
<span id="cb39-13"><a href=""></a><span class="co"># then calculate party votes for the same election</span></span>
<span id="cb39-14"><a href=""></a>party_votes_2019 <span class="ot">&lt;-</span> election_data <span class="sc">|&gt;</span> </span>
<span id="cb39-15"><a href=""></a>  <span class="fu">filter</span>(anno <span class="sc">==</span> <span class="dv">2019</span>, mes <span class="sc">==</span> <span class="dv">11</span>) <span class="sc">|&gt;</span>   <span class="co"># again, specifying November 2019</span></span>
<span id="cb39-16"><a href=""></a>  <span class="fu">mutate</span>(</span>
<span id="cb39-17"><a href=""></a>    <span class="at">party_group =</span> <span class="fu">case_when</span>(</span>
<span id="cb39-18"><a href=""></a>      partido_2 <span class="sc">==</span> <span class="st">"VOX"</span> <span class="sc">~</span> <span class="st">"VOX"</span>,</span>
<span id="cb39-19"><a href=""></a>      <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"OTHER"</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb39-20"><a href=""></a>  <span class="fu">group_by</span>(municipio, party_group) <span class="sc">|&gt;</span> </span>
<span id="cb39-21"><a href=""></a>  <span class="fu">summarise</span>(</span>
<span id="cb39-22"><a href=""></a>    <span class="at">votes =</span> <span class="fu">sum</span>(num_votos, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb39-23"><a href=""></a>    <span class="at">.groups =</span> <span class="st">'drop'</span>) <span class="sc">|&gt;</span> </span>
<span id="cb39-24"><a href=""></a>  <span class="fu">pivot_wider</span>(</span>
<span id="cb39-25"><a href=""></a>    <span class="at">names_from =</span> party_group,</span>
<span id="cb39-26"><a href=""></a>    <span class="at">values_from =</span> votes,</span>
<span id="cb39-27"><a href=""></a>    <span class="at">values_fill =</span> <span class="dv">0</span>)</span>
<span id="cb39-28"><a href=""></a></span>
<span id="cb39-29"><a href=""></a><span class="co"># join the two objects</span></span>
<span id="cb39-30"><a href=""></a>final_analysis <span class="ot">&lt;-</span> municipality_summary_2019 <span class="sc">|&gt;</span> </span>
<span id="cb39-31"><a href=""></a>  <span class="fu">left_join</span>(party_votes_2019, <span class="at">by =</span> <span class="st">"municipio"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb39-32"><a href=""></a>  <span class="fu">mutate</span>(</span>
<span id="cb39-33"><a href=""></a>    <span class="at">vox_share =</span> (VOX <span class="sc">/</span> valid_votes) <span class="sc">*</span> <span class="dv">100</span>) <span class="sc">|&gt;</span> </span>
<span id="cb39-34"><a href=""></a>  <span class="fu">select</span>(municipio, censo, turnout, vox_share)</span>
<span id="cb39-35"><a href=""></a></span>
<span id="cb39-36"><a href=""></a><span class="co"># calculate the correlation</span></span>
<span id="cb39-37"><a href=""></a><span class="fu">cor</span>(final_analysis<span class="sc">$</span>turnout, final_analysis<span class="sc">$</span>vox_share)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.003779757</code></pre>
</div>
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href=""></a>  <span class="co"># we tested for different sizes of municipalities by adding a population</span></span>
<span id="cb41-2"><a href=""></a>  <span class="co"># threshold; the correlations were more or less the same</span></span>
<span id="cb41-3"><a href=""></a></span>
<span id="cb41-4"><a href=""></a><span class="co"># visualise</span></span>
<span id="cb41-5"><a href=""></a>turnout_vox_share_plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(final_analysis) <span class="sc">+</span></span>
<span id="cb41-6"><a href=""></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x =</span> turnout, <span class="at">y =</span> vox_share), <span class="at">alpha =</span> <span class="fl">0.3</span>, <span class="at">color =</span> color_palette[<span class="dv">3</span>], <span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb41-7"><a href=""></a>  <span class="fu">geom_smooth</span>(<span class="fu">aes</span>(<span class="at">x =</span> turnout, <span class="at">y =</span> vox_share), <span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">TRUE</span>, <span class="at">color =</span> color_palette[<span class="dv">3</span>]) <span class="sc">+</span></span>
<span id="cb41-8"><a href=""></a>  <span class="fu">labs</span>(</span>
<span id="cb41-9"><a href=""></a>    <span class="at">title =</span> <span class="st">"Relationship between Turnout and VOX Vote Share (November 2019)"</span>,</span>
<span id="cb41-10"><a href=""></a>    <span class="at">subtitle =</span> <span class="st">"Analysis by Municipality"</span>,</span>
<span id="cb41-11"><a href=""></a>    <span class="at">x =</span> <span class="st">"Voter Turnout (%)"</span>,</span>
<span id="cb41-12"><a href=""></a>    <span class="at">y =</span> <span class="st">"VOX Vote Share (%)"</span></span>
<span id="cb41-13"><a href=""></a>  ) <span class="sc">+</span></span>
<span id="cb41-14"><a href=""></a>  <span class="fu">theme_presentation</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section class="slide level2">


<img data-src="presentation_files/figure-revealjs/unnamed-chunk-36-1.png" width="1152" class="r-stretch"></section>
<section class="slide level2">

<h3 id="visualising-the-geographic-concentration-in-the-support-of-vox">Visualising the geographic concentration in the support of Vox</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href=""></a>regional_analysis <span class="ot">&lt;-</span> election_data <span class="sc">|&gt;</span> </span>
<span id="cb42-2"><a href=""></a>  <span class="fu">filter</span>(anno <span class="sc">==</span> <span class="dv">2019</span>, mes <span class="sc">==</span> <span class="dv">11</span>) <span class="sc">|&gt;</span> </span>
<span id="cb42-3"><a href=""></a>  <span class="fu">group_by</span>(codigo_provincia) <span class="sc">|&gt;</span>  </span>
<span id="cb42-4"><a href=""></a>  <span class="fu">summarise</span>(<span class="at">total_votes =</span> <span class="fu">sum</span>(num_votos, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), </span>
<span id="cb42-5"><a href=""></a>            <span class="at">vox_share =</span> <span class="fu">sum</span>(num_votos[partido_2 <span class="sc">==</span> <span class="st">"VOX"</span>], <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">/</span> total_votes <span class="sc">*</span> <span class="dv">100</span>)</span>
<span id="cb42-6"><a href=""></a></span>
<span id="cb42-7"><a href=""></a><span class="co"># get geospatial data for Spanish provinces</span></span>
<span id="cb42-8"><a href=""></a>provinces <span class="ot">&lt;-</span> <span class="fu">esp_get_prov</span>() <span class="sc">|&gt;</span> </span>
<span id="cb42-9"><a href=""></a>  <span class="fu">mutate</span>(</span>
<span id="cb42-10"><a href=""></a>    <span class="at">provincia =</span> prov.shortname.en,</span>
<span id="cb42-11"><a href=""></a>    <span class="at">codigo_provincia =</span> <span class="fu">as.character</span>(cpro)) <span class="sc">|&gt;</span> </span>
<span id="cb42-12"><a href=""></a>  <span class="fu">select</span>(provincia, codigo_provincia)</span>
<span id="cb42-13"><a href=""></a></span>
<span id="cb42-14"><a href=""></a><span class="co"># transform to Mercator projection</span></span>
<span id="cb42-15"><a href=""></a>provinces <span class="ot">&lt;-</span> <span class="fu">st_transform</span>(provinces, <span class="dv">3857</span>)</span>
<span id="cb42-16"><a href=""></a></span>
<span id="cb42-17"><a href=""></a><span class="co"># get population data</span></span>
<span id="cb42-18"><a href=""></a>pop_prov <span class="ot">&lt;-</span> mapSpain<span class="sc">::</span>pobmun19 <span class="sc">|&gt;</span> </span>
<span id="cb42-19"><a href=""></a>  <span class="fu">rename</span>(<span class="at">codigo_provincia =</span> cpro) <span class="sc">|&gt;</span> </span>
<span id="cb42-20"><a href=""></a>  <span class="fu">mutate</span>(<span class="at">codigo_provincia =</span> <span class="fu">as.character</span>(codigo_provincia)) <span class="sc">|&gt;</span> </span>
<span id="cb42-21"><a href=""></a>  <span class="fu">group_by</span>(codigo_provincia) <span class="sc">|&gt;</span> </span>
<span id="cb42-22"><a href=""></a>  <span class="fu">summarise</span>(<span class="at">n_pop =</span> <span class="fu">sum</span>(pob19))</span>
<span id="cb42-23"><a href=""></a></span>
<span id="cb42-24"><a href=""></a><span class="co"># join all data</span></span>
<span id="cb42-25"><a href=""></a>final_data <span class="ot">&lt;-</span> provinces <span class="sc">%&gt;%</span></span>
<span id="cb42-26"><a href=""></a>  <span class="fu">left_join</span>(pop_prov, <span class="at">by =</span> <span class="st">"codigo_provincia"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb42-27"><a href=""></a>  <span class="fu">left_join</span>(regional_analysis, <span class="at">by =</span> <span class="st">"codigo_provincia"</span>)</span>
<span id="cb42-28"><a href=""></a></span>
<span id="cb42-29"><a href=""></a><span class="co"># set up font</span></span>
<span id="cb42-30"><a href=""></a>sysfonts<span class="sc">::</span><span class="fu">font_add_google</span>(<span class="st">"Roboto Condensed"</span>, <span class="at">family =</span> <span class="st">"rob_cond"</span>)</span>
<span id="cb42-31"><a href=""></a>showtext<span class="sc">::</span><span class="fu">showtext_auto</span>()</span>
<span id="cb42-32"><a href=""></a></span>
<span id="cb42-33"><a href=""></a><span class="co"># create color palette for VOX vote share</span></span>
<span id="cb42-34"><a href=""></a>vox_colors <span class="ot">&lt;-</span> <span class="fu">colorRampPalette</span>(<span class="fu">c</span>(<span class="st">"#FFFFFF"</span>, party_colors[<span class="st">"VOX"</span>]))(<span class="dv">5</span>)</span>
<span id="cb42-35"><a href=""></a></span>
<span id="cb42-36"><a href=""></a><span class="co"># create Dorling cartogram</span></span>
<span id="cb42-37"><a href=""></a>cartogram_plot <span class="ot">&lt;-</span> <span class="fu">cartogram_dorling</span>(final_data, <span class="at">weight =</span> <span class="st">"n_pop"</span>)</span>
<span id="cb42-38"><a href=""></a></span>
<span id="cb42-39"><a href=""></a><span class="co"># create the final plot</span></span>
<span id="cb42-40"><a href=""></a>cartogram_vox_plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(cartogram_plot) <span class="sc">+</span></span>
<span id="cb42-41"><a href=""></a>  <span class="fu">geom_sf</span>(<span class="fu">aes</span>(<span class="at">fill =</span> vox_share)) <span class="sc">+</span></span>
<span id="cb42-42"><a href=""></a>  <span class="fu">scale_fill_gradientn</span>(</span>
<span id="cb42-43"><a href=""></a>    <span class="at">colors =</span> vox_colors,</span>
<span id="cb42-44"><a href=""></a>    <span class="at">name =</span> <span class="st">"VOX Vote Share (%)"</span>,</span>
<span id="cb42-45"><a href=""></a>    <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fu">max</span>(regional_analysis<span class="sc">$</span>vox_share)),</span>
<span id="cb42-46"><a href=""></a>    <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="fu">max</span>(regional_analysis<span class="sc">$</span>vox_share), <span class="at">length.out =</span> <span class="dv">5</span>),</span>
<span id="cb42-47"><a href=""></a>    <span class="at">labels =</span> scales<span class="sc">::</span><span class="fu">label_number</span>(<span class="at">accuracy =</span> <span class="fl">0.1</span>)) <span class="sc">+</span></span>
<span id="cb42-48"><a href=""></a>  <span class="fu">theme_void</span>() <span class="sc">+</span></span>
<span id="cb42-49"><a href=""></a>  <span class="fu">labs</span>(</span>
<span id="cb42-50"><a href=""></a>    <span class="at">title =</span> <span class="st">"VOX Vote Share by Province (November 2019)"</span>,</span>
<span id="cb42-51"><a href=""></a>    <span class="at">subtitle =</span> <span class="st">"Circle size represents province population"</span>) <span class="sc">+</span></span>
<span id="cb42-52"><a href=""></a>  <span class="fu">theme</span>(</span>
<span id="cb42-53"><a href=""></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(</span>
<span id="cb42-54"><a href=""></a>      <span class="at">face =</span> <span class="st">"bold"</span>,</span>
<span id="cb42-55"><a href=""></a>      <span class="at">margin =</span> <span class="fu">unit</span>(<span class="fu">c</span>(<span class="fl">0.6</span>, <span class="dv">0</span>, <span class="fl">0.2</span>, <span class="dv">0</span>), <span class="st">"cm"</span>),</span>
<span id="cb42-56"><a href=""></a>      <span class="at">size =</span> <span class="dv">18</span>,</span>
<span id="cb42-57"><a href=""></a>      <span class="at">family =</span> <span class="st">"rob_cond"</span>),</span>
<span id="cb42-58"><a href=""></a>    <span class="at">plot.subtitle =</span> <span class="fu">element_text</span>(</span>
<span id="cb42-59"><a href=""></a>      <span class="at">family =</span> <span class="st">"rob_cond"</span>,</span>
<span id="cb42-60"><a href=""></a>      <span class="at">size =</span> <span class="dv">14</span>),</span>
<span id="cb42-61"><a href=""></a>    <span class="at">legend.title =</span> <span class="fu">element_text</span>(</span>
<span id="cb42-62"><a href=""></a>      <span class="at">face =</span> <span class="st">"bold"</span>,</span>
<span id="cb42-63"><a href=""></a>      <span class="at">family =</span> <span class="st">"rob_cond"</span>,</span>
<span id="cb42-64"><a href=""></a>      <span class="at">size =</span> <span class="dv">15</span>),</span>
<span id="cb42-65"><a href=""></a>    <span class="at">legend.text =</span> <span class="fu">element_text</span>(</span>
<span id="cb42-66"><a href=""></a>      <span class="at">family =</span> <span class="st">"rob_cond"</span>,</span>
<span id="cb42-67"><a href=""></a>      <span class="at">size =</span> <span class="dv">12</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section class="slide level2">


<img data-src="presentation_files/figure-revealjs/unnamed-chunk-38-1.png" width="1152" class="r-stretch"></section>
<section class="slide level2">

<h3 id="studying-electoral-fragmentation">Studying electoral fragmentation</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href=""></a>fragmentation_analysis <span class="ot">&lt;-</span> election_data <span class="sc">|&gt;</span> </span>
<span id="cb43-2"><a href=""></a>  <span class="fu">filter</span>(anno <span class="sc">==</span> <span class="dv">2019</span>, mes <span class="sc">==</span> <span class="dv">11</span>) <span class="sc">|&gt;</span> </span>
<span id="cb43-3"><a href=""></a>  <span class="fu">group_by</span>(municipio) <span class="sc">|&gt;</span> </span>
<span id="cb43-4"><a href=""></a>  <span class="fu">summarise</span>(</span>
<span id="cb43-5"><a href=""></a>    <span class="at">total_votes =</span> <span class="fu">sum</span>(num_votos, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb43-6"><a href=""></a>    <span class="at">vox_share =</span> <span class="fu">sum</span>(num_votos[partido_2 <span class="sc">==</span> <span class="st">"VOX"</span>], <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">/</span> total_votes <span class="sc">*</span> <span class="dv">100</span>,</span>
<span id="cb43-7"><a href=""></a>    <span class="at">pp_share =</span> <span class="fu">sum</span>(num_votos[partido_2 <span class="sc">==</span> <span class="st">"PARTIDO POPULAR"</span>], <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">/</span> total_votes <span class="sc">*</span> <span class="dv">100</span>,</span>
<span id="cb43-8"><a href=""></a>    <span class="at">psoe_share =</span> <span class="fu">sum</span>(num_votos[partido_2 <span class="sc">==</span> <span class="st">"PARTIDO SOCIALISTA OBRERO ESPAÑOL"</span>], <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">/</span> total_votes <span class="sc">*</span> <span class="dv">100</span>,</span>
<span id="cb43-9"><a href=""></a>    <span class="at">traditional_share =</span> pp_share <span class="sc">+</span> psoe_share,  <span class="co"># combined share of traditional parties</span></span>
<span id="cb43-10"><a href=""></a>    <span class="at">effective_parties =</span> <span class="dv">1</span> <span class="sc">/</span> <span class="fu">sum</span>((num_votos<span class="sc">/</span>total_votes)<span class="sc">^</span><span class="dv">2</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span>
<span id="cb43-11"><a href=""></a></span>
<span id="cb43-12"><a href=""></a><span class="co"># first visualisation: scatter plot of VOX share vs effective number of parties</span></span>
<span id="cb43-13"><a href=""></a>fragmentation_analysis_1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(fragmentation_analysis) <span class="sc">+</span></span>
<span id="cb43-14"><a href=""></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x =</span> effective_parties, <span class="at">y =</span> vox_share), </span>
<span id="cb43-15"><a href=""></a>             <span class="at">alpha =</span> <span class="fl">0.4</span>, <span class="at">color =</span> color_palette[<span class="dv">3</span>]) <span class="sc">+</span></span>
<span id="cb43-16"><a href=""></a>  <span class="fu">geom_smooth</span>(<span class="fu">aes</span>(<span class="at">x =</span> effective_parties, <span class="at">y =</span> vox_share), </span>
<span id="cb43-17"><a href=""></a>              <span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">color =</span> color_palette[<span class="dv">2</span>]) <span class="sc">+</span></span>
<span id="cb43-18"><a href=""></a>  <span class="fu">labs</span>(</span>
<span id="cb43-19"><a href=""></a>    <span class="at">title =</span> <span class="st">"VOX Support vs Electoral Fragmentation"</span>,</span>
<span id="cb43-20"><a href=""></a>    <span class="at">subtitle =</span> <span class="st">"November 2019 Elections"</span>,</span>
<span id="cb43-21"><a href=""></a>    <span class="at">x =</span> <span class="st">"Effective Number of Parties"</span>,</span>
<span id="cb43-22"><a href=""></a>    <span class="at">y =</span> <span class="st">"VOX Vote Share (%)"</span></span>
<span id="cb43-23"><a href=""></a>  ) <span class="sc">+</span></span>
<span id="cb43-24"><a href=""></a>  <span class="fu">theme_presentation</span>()</span>
<span id="cb43-25"><a href=""></a></span>
<span id="cb43-26"><a href=""></a><span class="co"># second visualisation: scatter plot with traditional party share</span></span>
<span id="cb43-27"><a href=""></a>fragmentation_analysis_2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(fragmentation_analysis) <span class="sc">+</span></span>
<span id="cb43-28"><a href=""></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x =</span> traditional_share, <span class="at">y =</span> vox_share), </span>
<span id="cb43-29"><a href=""></a>             <span class="at">alpha =</span> <span class="fl">0.4</span>, <span class="at">color =</span> color_palette[<span class="dv">6</span>]) <span class="sc">+</span></span>
<span id="cb43-30"><a href=""></a>  <span class="fu">geom_smooth</span>(<span class="fu">aes</span>(<span class="at">x =</span> traditional_share, <span class="at">y =</span> vox_share), </span>
<span id="cb43-31"><a href=""></a>              <span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">color =</span> color_palette[<span class="dv">10</span>]) <span class="sc">+</span></span>
<span id="cb43-32"><a href=""></a>  <span class="fu">labs</span>(</span>
<span id="cb43-33"><a href=""></a>    <span class="at">title =</span> <span class="st">"VOX Support vs Traditional Party Support"</span>,</span>
<span id="cb43-34"><a href=""></a>    <span class="at">subtitle =</span> <span class="st">"November 2019 Elections"</span>,</span>
<span id="cb43-35"><a href=""></a>    <span class="at">x =</span> <span class="st">"Combined PP + PSOE Vote Share (%)"</span>,</span>
<span id="cb43-36"><a href=""></a>    <span class="at">y =</span> <span class="st">"VOX Vote Share (%)"</span>) <span class="sc">+</span></span>
<span id="cb43-37"><a href=""></a>  <span class="fu">theme_presentation</span>()</span>
<span id="cb43-38"><a href=""></a></span>
<span id="cb43-39"><a href=""></a><span class="co"># calculate correlations</span></span>
<span id="cb43-40"><a href=""></a>cor_analysis <span class="ot">&lt;-</span> fragmentation_analysis <span class="sc">|&gt;</span> </span>
<span id="cb43-41"><a href=""></a>  <span class="fu">summarise</span>(</span>
<span id="cb43-42"><a href=""></a>    <span class="at">cor_fragmentation =</span> <span class="fu">cor</span>(effective_parties, vox_share, <span class="at">use =</span> <span class="st">"complete.obs"</span>),</span>
<span id="cb43-43"><a href=""></a>    <span class="at">cor_traditional =</span> <span class="fu">cor</span>(traditional_share, vox_share, <span class="at">use =</span> <span class="st">"complete.obs"</span>))</span>
<span id="cb43-44"><a href=""></a></span>
<span id="cb43-45"><a href=""></a><span class="fu">print</span>(<span class="st">"Correlation Analysis:"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Correlation Analysis:"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href=""></a><span class="fu">print</span>(cor_analysis)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 2
  cor_fragmentation cor_traditional
              &lt;dbl&gt;           &lt;dbl&gt;
1            0.0494           0.315</code></pre>
</div>
</div>
</section>
<section class="slide level2">


<img data-src="presentation_files/figure-revealjs/unnamed-chunk-40-1.png" width="1152" class="r-stretch"></section>
<section class="slide level2">


<img data-src="presentation_files/figure-revealjs/unnamed-chunk-41-1.png" width="1152" class="r-stretch"><div class="quarto-auto-generated-content">
<div class="footer footer-default">

</div>
</div>
</section>
    </div>
  </div>

  <script>window.backupDefine = window.define; window.define = undefined;</script>
  <script src="presentation_files/libs/revealjs/dist/reveal.js"></script>
  <!-- reveal.js plugins -->
  <script src="presentation_files/libs/revealjs/plugin/quarto-line-highlight/line-highlight.js"></script>
  <script src="presentation_files/libs/revealjs/plugin/pdf-export/pdfexport.js"></script>
  <script src="presentation_files/libs/revealjs/plugin/reveal-menu/menu.js"></script>
  <script src="presentation_files/libs/revealjs/plugin/reveal-menu/quarto-menu.js"></script>
  <script src="presentation_files/libs/revealjs/plugin/quarto-support/support.js"></script>
  

  <script src="presentation_files/libs/revealjs/plugin/notes/notes.js"></script>
  <script src="presentation_files/libs/revealjs/plugin/search/search.js"></script>
  <script src="presentation_files/libs/revealjs/plugin/zoom/zoom.js"></script>
  <script src="presentation_files/libs/revealjs/plugin/math/math.js"></script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script>

  <script>

      // Full list of configuration options available at:
      // https://revealjs.com/config/
      Reveal.initialize({
'controlsAuto': true,
'previewLinksAuto': false,
'pdfSeparateFragments': false,
'autoAnimateEasing': "ease",
'autoAnimateDuration': 1,
'autoAnimateUnmatched': true,
'menu': {"side":"left","useTextContentForMissingTitles":true,"markers":false,"loadIcons":false,"custom":[{"title":"Tools","icon":"<i class=\"fas fa-gear\"></i>","content":"<ul class=\"slide-menu-items\">\n<li class=\"slide-tool-item active\" data-item=\"0\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.fullscreen(event)\"><kbd>f</kbd> Fullscreen</a></li>\n<li class=\"slide-tool-item\" data-item=\"1\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.speakerMode(event)\"><kbd>s</kbd> Speaker View</a></li>\n<li class=\"slide-tool-item\" data-item=\"2\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.overview(event)\"><kbd>o</kbd> Slide Overview</a></li>\n<li class=\"slide-tool-item\" data-item=\"3\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.togglePdfExport(event)\"><kbd>e</kbd> PDF Export Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"4\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.keyboardHelp(event)\"><kbd>?</kbd> Keyboard Help</a></li>\n</ul>"}],"openButton":true},
'smaller': false,
 
        // Display controls in the bottom right corner
        controls: false,

        // Help the user learn the controls by providing hints, for example by
        // bouncing the down arrow when they first encounter a vertical slide
        controlsTutorial: false,

        // Determines where controls appear, "edges" or "bottom-right"
        controlsLayout: 'edges',

        // Visibility rule for backwards navigation arrows; "faded", "hidden"
        // or "visible"
        controlsBackArrows: 'faded',

        // Display a presentation progress bar
        progress: true,

        // Display the page number of the current slide
        slideNumber: false,

        // 'all', 'print', or 'speaker'
        showSlideNumber: 'all',

        // Add the current slide number to the URL hash so that reloading the
        // page/copying the URL will return you to the same slide
        hash: true,

        // Start with 1 for the hash rather than 0
        hashOneBasedIndex: false,

        // Flags if we should monitor the hash and change slides accordingly
        respondToHashChanges: true,

        // Push each slide change to the browser history
        history: true,

        // Enable keyboard shortcuts for navigation
        keyboard: true,

        // Enable the slide overview mode
        overview: true,

        // Disables the default reveal.js slide layout (scaling and centering)
        // so that you can use custom CSS layout
        disableLayout: false,

        // Vertical centering of slides
        center: false,

        // Enables touch navigation on devices with touch input
        touch: true,

        // Loop the presentation
        loop: false,

        // Change the presentation direction to be RTL
        rtl: false,

        // see https://revealjs.com/vertical-slides/#navigation-mode
        navigationMode: 'linear',

        // Randomizes the order of slides each time the presentation loads
        shuffle: false,

        // Turns fragments on and off globally
        fragments: true,

        // Flags whether to include the current fragment in the URL,
        // so that reloading brings you to the same fragment position
        fragmentInURL: false,

        // Flags if the presentation is running in an embedded mode,
        // i.e. contained within a limited portion of the screen
        embedded: false,

        // Flags if we should show a help overlay when the questionmark
        // key is pressed
        help: true,

        // Flags if it should be possible to pause the presentation (blackout)
        pause: true,

        // Flags if speaker notes should be visible to all viewers
        showNotes: false,

        // Global override for autoplaying embedded media (null/true/false)
        autoPlayMedia: null,

        // Global override for preloading lazy-loaded iframes (null/true/false)
        preloadIframes: null,

        // Number of milliseconds between automatically proceeding to the
        // next slide, disabled when set to 0, this value can be overwritten
        // by using a data-autoslide attribute on your slides
        autoSlide: 0,

        // Stop auto-sliding after user input
        autoSlideStoppable: true,

        // Use this method for navigation when auto-sliding
        autoSlideMethod: null,

        // Specify the average time in seconds that you think you will spend
        // presenting each slide. This is used to show a pacing timer in the
        // speaker view
        defaultTiming: null,

        // Enable slide navigation via mouse wheel
        mouseWheel: false,

        // The display mode that will be used to show slides
        display: 'block',

        // Hide cursor if inactive
        hideInactiveCursor: true,

        // Time before the cursor is hidden (in ms)
        hideCursorTime: 5000,

        // Opens links in an iframe preview overlay
        previewLinks: false,

        // Transition style (none/fade/slide/convex/concave/zoom)
        transition: 'none',

        // Transition speed (default/fast/slow)
        transitionSpeed: 'default',

        // Transition style for full page slide backgrounds
        // (none/fade/slide/convex/concave/zoom)
        backgroundTransition: 'none',

        // Number of slides away from the current that are visible
        viewDistance: 3,

        // Number of slides away from the current that are visible on mobile
        // devices. It is advisable to set this to a lower number than
        // viewDistance in order to save resources.
        mobileViewDistance: 2,

        // The "normal" size of the presentation, aspect ratio will be preserved
        // when the presentation is scaled to fit different resolutions. Can be
        // specified using percentage units.
        width: 1050,

        height: 700,

        // Factor of the display size that should remain empty around the content
        margin: 0.1,

        math: {
          mathjax: 'https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js',
          config: 'TeX-AMS_HTML-full',
          tex2jax: {
            inlineMath: [['\\(','\\)']],
            displayMath: [['\\[','\\]']],
            balanceBraces: true,
            processEscapes: false,
            processRefs: true,
            processEnvironments: true,
            preview: 'TeX',
            skipTags: ['script','noscript','style','textarea','pre','code'],
            ignoreClass: 'tex2jax_ignore',
            processClass: 'tex2jax_process'
          },
        },

        // reveal.js plugins
        plugins: [QuartoLineHighlight, PdfExport, RevealMenu, QuartoSupport,

          RevealMath,
          RevealNotes,
          RevealSearch,
          RevealZoom
        ]
      });
    </script>
    
    <script>
      // htmlwidgets need to know to resize themselves when slides are shown/hidden.
      // Fire the "slideenter" event (handled by htmlwidgets.js) when the current
      // slide changes (different for each slide format).
      (function () {
        // dispatch for htmlwidgets
        function fireSlideEnter() {
          const event = window.document.createEvent("Event");
          event.initEvent("slideenter", true, true);
          window.document.dispatchEvent(event);
        }

        function fireSlideChanged(previousSlide, currentSlide) {
          fireSlideEnter();

          // dispatch for shiny
          if (window.jQuery) {
            if (previousSlide) {
              window.jQuery(previousSlide).trigger("hidden");
            }
            if (currentSlide) {
              window.jQuery(currentSlide).trigger("shown");
            }
          }
        }

        // hookup for slidy
        if (window.w3c_slidy) {
          window.w3c_slidy.add_observer(function (slide_num) {
            // slide_num starts at position 1
            fireSlideChanged(null, w3c_slidy.slides[slide_num - 1]);
          });
        }

      })();
    </script>

    <script id="quarto-html-after-body" type="application/javascript">
    window.document.addEventListener("DOMContentLoaded", function (event) {
      const toggleBodyColorMode = (bsSheetEl) => {
        const mode = bsSheetEl.getAttribute("data-mode");
        const bodyEl = window.document.querySelector("body");
        if (mode === "dark") {
          bodyEl.classList.add("quarto-dark");
          bodyEl.classList.remove("quarto-light");
        } else {
          bodyEl.classList.add("quarto-light");
          bodyEl.classList.remove("quarto-dark");
        }
      }
      const toggleBodyColorPrimary = () => {
        const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
        if (bsSheetEl) {
          toggleBodyColorMode(bsSheetEl);
        }
      }
      toggleBodyColorPrimary();  
      const tabsets =  window.document.querySelectorAll(".panel-tabset-tabby")
      tabsets.forEach(function(tabset) {
        const tabby = new Tabby('#' + tabset.id);
      });
      const isCodeAnnotation = (el) => {
        for (const clz of el.classList) {
          if (clz.startsWith('code-annotation-')) {                     
            return true;
          }
        }
        return false;
      }
      const onCopySuccess = function(e) {
        // button target
        const button = e.trigger;
        // don't keep focus
        button.blur();
        // flash "checked"
        button.classList.add('code-copy-button-checked');
        var currentTitle = button.getAttribute("title");
        button.setAttribute("title", "Copied!");
        let tooltip;
        if (window.bootstrap) {
          button.setAttribute("data-bs-toggle", "tooltip");
          button.setAttribute("data-bs-placement", "left");
          button.setAttribute("data-bs-title", "Copied!");
          tooltip = new bootstrap.Tooltip(button, 
            { trigger: "manual", 
              customClass: "code-copy-button-tooltip",
              offset: [0, -8]});
          tooltip.show();    
        }
        setTimeout(function() {
          if (tooltip) {
            tooltip.hide();
            button.removeAttribute("data-bs-title");
            button.removeAttribute("data-bs-toggle");
            button.removeAttribute("data-bs-placement");
          }
          button.setAttribute("title", currentTitle);
          button.classList.remove('code-copy-button-checked');
        }, 1000);
        // clear code selection
        e.clearSelection();
      }
      const getTextToCopy = function(trigger) {
          const codeEl = trigger.previousElementSibling.cloneNode(true);
          for (const childEl of codeEl.children) {
            if (isCodeAnnotation(childEl)) {
              childEl.remove();
            }
          }
          return codeEl.innerText;
      }
      const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
        text: getTextToCopy
      });
      clipboard.on('success', onCopySuccess);
      if (window.document.getElementById('quarto-embedded-source-code-modal')) {
        // For code content inside modals, clipBoardJS needs to be initialized with a container option
        // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
        const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
          text: getTextToCopy,
          container: window.document.getElementById('quarto-embedded-source-code-modal')
        });
        clipboardModal.on('success', onCopySuccess);
      }
        var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
        var mailtoRegex = new RegExp(/^mailto:/);
          var filterRegex = new RegExp('/' + window.location.host + '/');
        var isInternal = (href) => {
            return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
        }
        // Inspect non-navigation links and adorn them if external
     	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
        for (var i=0; i<links.length; i++) {
          const link = links[i];
          if (!isInternal(link.href)) {
            // undo the damage that might have been done by quarto-nav.js in the case of
            // links that we want to consider external
            if (link.dataset.originalHref !== undefined) {
              link.href = link.dataset.originalHref;
            }
          }
        }
      function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
        const config = {
          allowHTML: true,
          maxWidth: 500,
          delay: 100,
          arrow: false,
          appendTo: function(el) {
              return el.closest('section.slide') || el.parentElement;
          },
          interactive: true,
          interactiveBorder: 10,
          theme: 'light-border',
          placement: 'bottom-start',
        };
        if (contentFn) {
          config.content = contentFn;
        }
        if (onTriggerFn) {
          config.onTrigger = onTriggerFn;
        }
        if (onUntriggerFn) {
          config.onUntrigger = onUntriggerFn;
        }
          config['offset'] = [0,0];
          config['maxWidth'] = 700;
        window.tippy(el, config); 
      }
      const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
      for (var i=0; i<noterefs.length; i++) {
        const ref = noterefs[i];
        tippyHover(ref, function() {
          // use id or data attribute instead here
          let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
          try { href = new URL(href).hash; } catch {}
          const id = href.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note) {
            return note.innerHTML;
          } else {
            return "";
          }
        });
      }
      const findCites = (el) => {
        const parentEl = el.parentElement;
        if (parentEl) {
          const cites = parentEl.dataset.cites;
          if (cites) {
            return {
              el,
              cites: cites.split(' ')
            };
          } else {
            return findCites(el.parentElement)
          }
        } else {
          return undefined;
        }
      };
      var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
      for (var i=0; i<bibliorefs.length; i++) {
        const ref = bibliorefs[i];
        const citeInfo = findCites(ref);
        if (citeInfo) {
          tippyHover(citeInfo.el, function() {
            var popup = window.document.createElement('div');
            citeInfo.cites.forEach(function(cite) {
              var citeDiv = window.document.createElement('div');
              citeDiv.classList.add('hanging-indent');
              citeDiv.classList.add('csl-entry');
              var biblioDiv = window.document.getElementById('ref-' + cite);
              if (biblioDiv) {
                citeDiv.innerHTML = biblioDiv.innerHTML;
              }
              popup.appendChild(citeDiv);
            });
            return popup.innerHTML;
          });
        }
      }
    });
    </script>
    

</body></html>